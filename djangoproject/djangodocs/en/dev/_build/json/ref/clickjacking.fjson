{"parents": [{"link": "../", "title": "API Reference"}], "prev": {"link": "../class-based-views/flattened-index/", "title": "Class-based generic views - flattened index"}, "next": {"link": "../contrib/", "title": "<code class=\"docutils literal notranslate\"><span class=\"pre\">contrib</span></code> packages"}, "title": "Clickjacking Protection", "meta": {}, "body": "<div class=\"section\" id=\"s-module-django.middleware.clickjacking\">\n<span id=\"s-clickjacking-protection\"></span><span id=\"module-django.middleware.clickjacking\"></span><span id=\"clickjacking-protection\"></span><h1>Clickjacking Protection<a class=\"headerlink\" href=\"#module-django.middleware.clickjacking\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>The clickjacking middleware and decorators provide easy-to-use protection\nagainst <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Clickjacking\">clickjacking</a>.  This type of attack occurs when a malicious site\ntricks a user into clicking on a concealed element of another site which they\nhave loaded in a hidden frame or iframe.</p>\n<div class=\"section\" id=\"s-an-example-of-clickjacking\">\n<span id=\"an-example-of-clickjacking\"></span><h2>An example of clickjacking<a class=\"headerlink\" href=\"#an-example-of-clickjacking\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Suppose an online store has a page where a logged in user can click \u201cBuy Now\u201d to\npurchase an item. A user has chosen to stay logged into the store all the time\nfor convenience. An attacker site might create an \u201cI Like Ponies\u201d button on one\nof their own pages, and load the store\u2019s page in a transparent iframe such that\nthe \u201cBuy Now\u201d button is invisibly overlaid on the \u201cI Like Ponies\u201d button. If the\nuser visits the attacker\u2019s site, clicking \u201cI Like Ponies\u201d will cause an\ninadvertent click on the \u201cBuy Now\u201d button and an unknowing purchase of the item.</p>\n</div>\n<div class=\"section\" id=\"s-preventing-clickjacking\">\n<span id=\"s-clickjacking-prevention\"></span><span id=\"preventing-clickjacking\"></span><span id=\"clickjacking-prevention\"></span><h2>Preventing clickjacking<a class=\"headerlink\" href=\"#preventing-clickjacking\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Modern browsers honor the <a class=\"reference external\" href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\">X-Frame-Options</a> HTTP header that indicates whether\nor not a resource is allowed to load within a frame or iframe. If the response\ncontains the header with a value of <code class=\"docutils literal notranslate\"><span class=\"pre\">SAMEORIGIN</span></code> then the browser will only\nload the resource in a frame if the request originated from the same site. If\nthe header is set to <code class=\"docutils literal notranslate\"><span class=\"pre\">DENY</span></code> then the browser will block the resource from\nloading in a frame no matter which site made the request.</p>\n<p>Django provides a few ways to include this header in responses from your site:</p>\n<ol class=\"arabic simple\">\n<li>A middleware that sets the header in all responses.</li>\n<li>A set of view decorators that can be used to override the middleware or to\nonly set the header for certain views.</li>\n</ol>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> HTTP header will only be set by the middleware or view\ndecorators if it is not already present in the response.</p>\n</div>\n<div class=\"section\" id=\"s-how-to-use-it\">\n<span id=\"how-to-use-it\"></span><h2>How to use it<a class=\"headerlink\" href=\"#how-to-use-it\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"s-setting-x-frame-options-for-all-responses\">\n<span id=\"setting-x-frame-options-for-all-responses\"></span><h3>Setting <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> for all responses<a class=\"headerlink\" href=\"#setting-x-frame-options-for-all-responses\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>To set the same <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> value for all responses in your site, put\n<code class=\"docutils literal notranslate\"><span class=\"pre\">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span></code> to\n<a class=\"reference internal\" href=\"../settings/#std-setting-MIDDLEWARE\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">MIDDLEWARE</span></code></a>:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">MIDDLEWARE</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"o\">...</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;django.middleware.clickjacking.XFrameOptionsMiddleware&quot;</span><span class=\"p\">,</span>\n    <span class=\"o\">...</span><span class=\"p\">,</span>\n<span class=\"p\">]</span>\n</pre></div>\n</div>\n<p>This middleware is enabled in the settings file generated by\n<a class=\"reference internal\" href=\"../django-admin/#django-admin-startproject\"><code class=\"xref std std-djadmin docutils literal notranslate\"><span class=\"pre\">startproject</span></code></a>.</p>\n<p>By default, the middleware will set the <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> header to\n<code class=\"docutils literal notranslate\"><span class=\"pre\">DENY</span></code> for every outgoing <code class=\"docutils literal notranslate\"><span class=\"pre\">HttpResponse</span></code>. If you want any other value for\nthis header instead, set the <a class=\"reference internal\" href=\"../settings/#std-setting-X_FRAME_OPTIONS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">X_FRAME_OPTIONS</span></code></a> setting:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">X_FRAME_OPTIONS</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;SAMEORIGIN&quot;</span>\n</pre></div>\n</div>\n<p>When using the middleware there may be some views where you do <strong>not</strong> want the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> header set. For those cases, you can use a view decorator\nthat tells the middleware not to set the header:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">django.http</span> <span class=\"kn\">import</span> <span class=\"n\">HttpResponse</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.views.decorators.clickjacking</span> <span class=\"kn\">import</span> <span class=\"n\">xframe_options_exempt</span>\n\n\n<span class=\"nd\">@xframe_options_exempt</span>\n<span class=\"k\">def</span> <span class=\"nf\">ok_to_load_in_a_frame</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">HttpResponse</span><span class=\"p\">(</span><span class=\"s2\">&quot;This page is safe to load in a frame on any site.&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"admonition note\">\n<p class=\"first admonition-title\">Note</p>\n<p class=\"last\">If you want to submit a form or access a session cookie within a frame or\niframe, you may need to modify the <a class=\"reference internal\" href=\"../settings/#std-setting-CSRF_COOKIE_SAMESITE\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">CSRF_COOKIE_SAMESITE</span></code></a> or\n<a class=\"reference internal\" href=\"../settings/#std-setting-SESSION_COOKIE_SAMESITE\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">SESSION_COOKIE_SAMESITE</span></code></a> settings.</p>\n</div>\n<div class=\"versionchanged\">\n<span class=\"title\">Changed in Django Development version:</span> <p>Support for wrapping asynchronous view functions was added to the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;xframe_options_exempt</span></code> decorator.</p>\n</div>\n</div>\n<div class=\"section\" id=\"s-setting-x-frame-options-per-view\">\n<span id=\"setting-x-frame-options-per-view\"></span><h3>Setting <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> per view<a class=\"headerlink\" href=\"#setting-x-frame-options-per-view\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>To set the <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> header on a per view basis, Django provides these\ndecorators:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">django.http</span> <span class=\"kn\">import</span> <span class=\"n\">HttpResponse</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.views.decorators.clickjacking</span> <span class=\"kn\">import</span> <span class=\"n\">xframe_options_deny</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.views.decorators.clickjacking</span> <span class=\"kn\">import</span> <span class=\"n\">xframe_options_sameorigin</span>\n\n\n<span class=\"nd\">@xframe_options_deny</span>\n<span class=\"k\">def</span> <span class=\"nf\">view_one</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">HttpResponse</span><span class=\"p\">(</span><span class=\"s2\">&quot;I won&#39;t display in any frame!&quot;</span><span class=\"p\">)</span>\n\n\n<span class=\"nd\">@xframe_options_sameorigin</span>\n<span class=\"k\">def</span> <span class=\"nf\">view_two</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">HttpResponse</span><span class=\"p\">(</span><span class=\"s2\">&quot;Display in a frame if it&#39;s from the same origin as me.&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Note that you can use the decorators in conjunction with the middleware. Use of\na decorator overrides the middleware.</p>\n<div class=\"versionchanged\">\n<span class=\"title\">Changed in Django Development version:</span> <p>Support for wrapping asynchronous view functions was added to the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;xframe_options_deny</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;xframe_options_sameorigin</span></code> decorators.</p>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"s-limitations\">\n<span id=\"limitations\"></span><h2>Limitations<a class=\"headerlink\" href=\"#limitations\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> header will only protect against clickjacking in a\nmodern browser. Older browsers will quietly ignore the header and need <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Clickjacking#Prevention\">other\nclickjacking prevention techniques</a>.</p>\n<div class=\"section\" id=\"s-browsers-that-support-x-frame-options\">\n<span id=\"browsers-that-support-x-frame-options\"></span><h3>Browsers that support <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code><a class=\"headerlink\" href=\"#browsers-that-support-x-frame-options\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<ul class=\"simple\">\n<li>Internet Explorer 8+</li>\n<li>Edge</li>\n<li>Firefox 3.6.9+</li>\n<li>Opera 10.5+</li>\n<li>Safari 4+</li>\n<li>Chrome 4.1+</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-see-also\">\n<span id=\"see-also\"></span><h3>See also<a class=\"headerlink\" href=\"#see-also\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>A <a class=\"reference external\" href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options#browser_compatibility\">complete list</a> of browsers supporting <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code>.</p>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["ref/contrib/index", "<code class=\"docutils literal notranslate\"><span class=\"pre\">contrib</span></code> packages", "N", "next"], ["ref/class-based-views/flattened-index", "Class-based generic views - flattened index", "P", "previous"]], "sourcename": "ref/clickjacking.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Clickjacking Protection</a><ul>\n<li><a class=\"reference internal\" href=\"#an-example-of-clickjacking\">An example of clickjacking</a></li>\n<li><a class=\"reference internal\" href=\"#preventing-clickjacking\">Preventing clickjacking</a></li>\n<li><a class=\"reference internal\" href=\"#how-to-use-it\">How to use it</a><ul>\n<li><a class=\"reference internal\" href=\"#setting-x-frame-options-for-all-responses\">Setting <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> for all responses</a></li>\n<li><a class=\"reference internal\" href=\"#setting-x-frame-options-per-view\">Setting <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code> per view</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#limitations\">Limitations</a><ul>\n<li><a class=\"reference internal\" href=\"#browsers-that-support-x-frame-options\">Browsers that support <code class=\"docutils literal notranslate\"><span class=\"pre\">X-Frame-Options</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#see-also\">See also</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".txt", "current_page_name": "ref/clickjacking", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}
