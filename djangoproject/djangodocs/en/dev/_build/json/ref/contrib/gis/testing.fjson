{"parents": [{"link": "../../../", "title": "API Reference"}, {"link": "../../", "title": "<code class=\"docutils literal notranslate\"><span class=\"pre\">contrib</span></code> packages"}, {"link": "../", "title": "GeoDjango"}], "prev": {"link": "../sitemaps/", "title": "Geographic Sitemaps"}, "next": {"link": "../deployment/", "title": "Deploying GeoDjango"}, "title": "Testing GeoDjango apps", "meta": {}, "body": "<div class=\"section\" id=\"s-testing-geodjango-apps\">\n<span id=\"testing-geodjango-apps\"></span><h1>Testing GeoDjango apps<a class=\"headerlink\" href=\"#testing-geodjango-apps\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>Included in this documentation are some additional notes and settings\nfor <a class=\"reference internal\" href=\"#testing-postgis\"><span class=\"std std-ref\">PostGIS</span></a> users.</p>\n<div class=\"section\" id=\"s-postgis\">\n<span id=\"s-testing-postgis\"></span><span id=\"postgis\"></span><span id=\"testing-postgis\"></span><h2>PostGIS<a class=\"headerlink\" href=\"#postgis\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"s-settings\">\n<span id=\"settings\"></span><h3>Settings<a class=\"headerlink\" href=\"#settings\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<div class=\"admonition note\">\n<p class=\"first admonition-title\">Note</p>\n<p class=\"last\">The settings below have sensible defaults, and shouldn\u2019t require manual setting.</p>\n</div>\n<div class=\"section\" id=\"s-postgis-version\">\n<span id=\"s-std-setting-POSTGIS_VERSION\"></span><span id=\"s-std:setting-POSTGIS_VERSION\"></span><span id=\"postgis-version\"></span><span id=\"std-setting-POSTGIS_VERSION\"></span><span id=\"std:setting-POSTGIS_VERSION\"></span><h4><code class=\"docutils literal notranslate\"><span class=\"pre\">POSTGIS_VERSION</span></code><a class=\"headerlink\" href=\"#postgis-version\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>When GeoDjango\u2019s spatial backend initializes on PostGIS, it has to perform\nan SQL query to determine the version in order to figure out what\nfeatures are available. Advanced users wishing to prevent this additional\nquery may set the version manually using a 3-tuple of integers specifying\nthe major, minor, and micro version numbers for PostGIS. For example,\nto configure for PostGIS X.Y.Z you would use:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">POSTGIS_VERSION</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">Z</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"s-obtaining-sufficient-privileges\">\n<span id=\"obtaining-sufficient-privileges\"></span><h3>Obtaining sufficient privileges<a class=\"headerlink\" href=\"#obtaining-sufficient-privileges\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Depending on your configuration, this section describes several methods to\nconfigure a database user with sufficient privileges to run tests for\nGeoDjango applications on PostgreSQL. If your\n<a class=\"reference internal\" href=\"../install/postgis/#spatialdb-template\"><span class=\"std std-ref\">spatial database template</span></a>\nwas created like in the instructions, then your testing database user\nonly needs to have the ability to create databases. In other configurations,\nyou may be required to use a database superuser.</p>\n<div class=\"section\" id=\"s-create-database-user\">\n<span id=\"create-database-user\"></span><h4>Create database user<a class=\"headerlink\" href=\"#create-database-user\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>To make a database user with the ability to create databases, use the\nfollowing command:</p>\n<div class=\"highlight-shell notranslate\"><div class=\"highlight\"><pre><span></span>$ createuser --createdb -R -S &lt;user_name&gt;\n</pre></div>\n</div>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">-R</span> <span class=\"pre\">-S</span></code> flags indicate that we do not want the user to have the ability\nto create additional users (roles) or to be a superuser, respectively.</p>\n<p>Alternatively, you may alter an existing user\u2019s role from the SQL shell\n(assuming this is done from an existing superuser account):</p>\n<div class=\"highlight-psql notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">postgres</span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"k\">ALTER</span><span class=\"w\"> </span><span class=\"k\">ROLE</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">user_name</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">CREATEDB</span><span class=\"w\"> </span><span class=\"n\">NOSUPERUSER</span><span class=\"w\"> </span><span class=\"n\">NOCREATEROLE</span><span class=\"p\">;</span><span class=\"w\"></span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"s-create-database-superuser\">\n<span id=\"create-database-superuser\"></span><h4>Create database superuser<a class=\"headerlink\" href=\"#create-database-superuser\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>This may be done at the time the user is created, for example:</p>\n<div class=\"highlight-shell notranslate\"><div class=\"highlight\"><pre><span></span>$ createuser --superuser &lt;user_name&gt;\n</pre></div>\n</div>\n<p>Or you may alter the user\u2019s role from the SQL shell (assuming this\nis done from an existing superuser account):</p>\n<div class=\"highlight-psql notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">postgres</span><span class=\"o\">#</span><span class=\"w\"> </span><span class=\"k\">ALTER</span><span class=\"w\"> </span><span class=\"k\">ROLE</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">user_name</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">SUPERUSER</span><span class=\"p\">;</span><span class=\"w\"></span>\n</pre></div>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"s-windows\">\n<span id=\"windows\"></span><h3>Windows<a class=\"headerlink\" href=\"#windows\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>On Windows platforms you can use the pgAdmin III utility to add superuser\nprivileges to your database user.</p>\n<p>By default, the PostGIS installer on Windows includes a template\nspatial database entitled <code class=\"docutils literal notranslate\"><span class=\"pre\">template_postgis</span></code>.</p>\n</div>\n</div>\n<div class=\"section\" id=\"s-geodjango-tests\">\n<span id=\"s-id1\"></span><span id=\"geodjango-tests\"></span><span id=\"id1\"></span><h2>GeoDjango tests<a class=\"headerlink\" href=\"#geodjango-tests\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>To have the GeoDjango tests executed when <a class=\"reference internal\" href=\"../../../../internals/contributing/writing-code/unit-tests/#running-unit-tests\"><span class=\"std std-ref\">running the Django test suite</span></a> with <code class=\"docutils literal notranslate\"><span class=\"pre\">runtests.py</span></code> all of the databases in the settings\nfile must be using one of the <a class=\"reference internal\" href=\"../db-api/#spatial-backends\"><span class=\"std std-ref\">spatial database backends</span></a>.</p>\n<div class=\"section\" id=\"s-example\">\n<span id=\"example\"></span><h3>Example<a class=\"headerlink\" href=\"#example\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The following is an example bare-bones settings file with spatial backends\nthat can be used to run the entire Django test suite, including those\nin <a class=\"reference internal\" href=\"../#module-django.contrib.gis\" title=\"django.contrib.gis: Geographic Information System (GIS) extensions for Django\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.gis</span></code></a>:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">DATABASES</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">&quot;default&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;ENGINE&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;django.contrib.gis.db.backends.postgis&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;NAME&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;geodjango&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;USER&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;geodjango&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">},</span>\n    <span class=\"s2\">&quot;other&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;ENGINE&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;django.contrib.gis.db.backends.postgis&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;NAME&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;other&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;USER&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;geodjango&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">},</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">SECRET_KEY</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;django_tests_secret_key&quot;</span>\n</pre></div>\n</div>\n<p>Assuming the settings above were in a <code class=\"docutils literal notranslate\"><span class=\"pre\">postgis.py</span></code> file in the same\ndirectory as <code class=\"docutils literal notranslate\"><span class=\"pre\">runtests.py</span></code>, then all Django and GeoDjango tests would\nbe performed when executing the command:</p>\n<div class=\"highlight-shell notranslate\"><div class=\"highlight\"><pre><span></span>$ ./runtests.py --settings<span class=\"o\">=</span>postgis\n</pre></div>\n</div>\n<p>To run only the GeoDjango test suite, specify <code class=\"docutils literal notranslate\"><span class=\"pre\">gis_tests</span></code>:</p>\n<div class=\"highlight-shell notranslate\"><div class=\"highlight\"><pre><span></span>$ ./runtests.py --settings<span class=\"o\">=</span>postgis gis_tests\n</pre></div>\n</div>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["ref/contrib/gis/deployment", "Deploying GeoDjango", "N", "next"], ["ref/contrib/gis/sitemaps", "Geographic Sitemaps", "P", "previous"]], "sourcename": "ref/contrib/gis/testing.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Testing GeoDjango apps</a><ul>\n<li><a class=\"reference internal\" href=\"#postgis\">PostGIS</a><ul>\n<li><a class=\"reference internal\" href=\"#settings\">Settings</a><ul>\n<li><a class=\"reference internal\" href=\"#postgis-version\"><code class=\"docutils literal notranslate\"><span class=\"pre\">POSTGIS_VERSION</span></code></a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#obtaining-sufficient-privileges\">Obtaining sufficient privileges</a><ul>\n<li><a class=\"reference internal\" href=\"#create-database-user\">Create database user</a></li>\n<li><a class=\"reference internal\" href=\"#create-database-superuser\">Create database superuser</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#windows\">Windows</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#geodjango-tests\">GeoDjango tests</a><ul>\n<li><a class=\"reference internal\" href=\"#example\">Example</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".txt", "current_page_name": "ref/contrib/gis/testing", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}