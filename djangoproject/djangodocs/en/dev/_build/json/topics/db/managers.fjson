{"parents": [{"link": "../../", "title": "Using Django"}, {"link": "../", "title": "Models and databases"}], "prev": {"link": "../search/", "title": "Search"}, "next": {"link": "../sql/", "title": "Performing raw SQL queries"}, "title": "Managers", "meta": {}, "body": "<div class=\"section\" id=\"s-managers\">\n<span id=\"managers\"></span><h1>Managers<a class=\"headerlink\" href=\"#managers\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"django.db.models.Manager\">\n<em class=\"property\"><span class=\"pre\">class</span><span class=\"w\"> </span></em><code class=\"sig-name descname\"><span class=\"pre\">Manager</span></code><a class=\"reference internal\" href=\"../../../_modules/django/db/models/manager/#Manager\"><span class=\"viewcode-link\"><span class=\"pre\">[source]</span></span></a><a class=\"headerlink\" href=\"#django.db.models.Manager\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd></dd></dl>\n\n<p>A <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> is the interface through which database query operations are\nprovided to Django models. At least one <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> exists for every model in\na Django application.</p>\n<p>The way <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> classes work is documented in <a class=\"reference internal\" href=\"../queries/\"><span class=\"doc\">Making queries</span></a>;\nthis document specifically touches on model options that customize <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>\nbehavior.</p>\n<div class=\"section\" id=\"s-manager-names\">\n<span id=\"s-id1\"></span><span id=\"manager-names\"></span><span id=\"id1\"></span><h2>Manager names<a class=\"headerlink\" href=\"#manager-names\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>By default, Django adds a <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> with the name <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code> to every Django\nmodel class. However, if you want to use <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code> as a field name, or if you\nwant to use a name other than <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code> for the <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>, you can rename\nit on a per-model basis. To rename the <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> for a given class, define a\nclass attribute of type <code class=\"docutils literal notranslate\"><span class=\"pre\">models.Manager()</span></code> on that model. For example:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">django.db</span> <span class=\"kn\">import</span> <span class=\"n\">models</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Person</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"n\">people</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Using this example model, <code class=\"docutils literal notranslate\"><span class=\"pre\">Person.objects</span></code> will generate an\n<code class=\"docutils literal notranslate\"><span class=\"pre\">AttributeError</span></code> exception, but <code class=\"docutils literal notranslate\"><span class=\"pre\">Person.people.all()</span></code> will provide a list\nof all <code class=\"docutils literal notranslate\"><span class=\"pre\">Person</span></code> objects.</p>\n</div>\n<div class=\"section\" id=\"s-custom-managers\">\n<span id=\"s-id2\"></span><span id=\"custom-managers\"></span><span id=\"id2\"></span><h2>Custom managers<a class=\"headerlink\" href=\"#custom-managers\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>You can use a custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> in a particular model by extending the base\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> class and instantiating your custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> in your model.</p>\n<p>There are two reasons you might want to customize a <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>: to add extra\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> methods, and/or to modify the initial <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> the <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>\nreturns.</p>\n<div class=\"section\" id=\"s-adding-extra-manager-methods\">\n<span id=\"adding-extra-manager-methods\"></span><h3>Adding extra manager methods<a class=\"headerlink\" href=\"#adding-extra-manager-methods\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Adding extra <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> methods is the preferred way to add \u201ctable-level\u201d\nfunctionality to your models. (For \u201crow-level\u201d functionality \u2013 i.e., functions\nthat act on a single instance of a model object \u2013 use <a class=\"reference internal\" href=\"../models/#model-methods\"><span class=\"std std-ref\">Model methods</span></a>, not custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> methods.)</p>\n<p>For example, this custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> adds a method <code class=\"docutils literal notranslate\"><span class=\"pre\">with_counts()</span></code>:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">django.db</span> <span class=\"kn\">import</span> <span class=\"n\">models</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.db.models.functions</span> <span class=\"kn\">import</span> <span class=\"n\">Coalesce</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">PollManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">with_counts</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"n\">num_responses</span><span class=\"o\">=</span><span class=\"n\">Coalesce</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Count</span><span class=\"p\">(</span><span class=\"s2\">&quot;response&quot;</span><span class=\"p\">),</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">OpinionPoll</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">question</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">200</span><span class=\"p\">)</span>\n    <span class=\"n\">objects</span> <span class=\"o\">=</span> <span class=\"n\">PollManager</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Response</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">poll</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">ForeignKey</span><span class=\"p\">(</span><span class=\"n\">OpinionPoll</span><span class=\"p\">,</span> <span class=\"n\">on_delete</span><span class=\"o\">=</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CASCADE</span><span class=\"p\">)</span>\n    <span class=\"c1\"># ...</span>\n</pre></div>\n</div>\n<p>With this example, you\u2019d use <code class=\"docutils literal notranslate\"><span class=\"pre\">OpinionPoll.objects.with_counts()</span></code> to get a\n<code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> of <code class=\"docutils literal notranslate\"><span class=\"pre\">OpinionPoll</span></code> objects with the extra <code class=\"docutils literal notranslate\"><span class=\"pre\">num_responses</span></code>\nattribute attached.</p>\n<p>A custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> method can return anything you want. It doesn\u2019t have to\nreturn a <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code>.</p>\n<p>Another thing to note is that <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> methods can access <code class=\"docutils literal notranslate\"><span class=\"pre\">self.model</span></code> to\nget the model class to which they\u2019re attached.</p>\n</div>\n<div class=\"section\" id=\"s-modifying-a-manager-s-initial-queryset\">\n<span id=\"modifying-a-manager-s-initial-queryset\"></span><h3>Modifying a manager\u2019s initial <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code><a class=\"headerlink\" href=\"#modifying-a-manager-s-initial-queryset\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>A <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>\u2019s base <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> returns all objects in the system. For\nexample, using this model:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">django.db</span> <span class=\"kn\">import</span> <span class=\"n\">models</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Book</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n    <span class=\"n\">author</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>\u2026the statement <code class=\"docutils literal notranslate\"><span class=\"pre\">Book.objects.all()</span></code> will return all books in the database.</p>\n<p>You can override a <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>\u2019s base <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> by overriding the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Manager.get_queryset()</span></code> method. <code class=\"docutils literal notranslate\"><span class=\"pre\">get_queryset()</span></code> should return a\n<code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> with the properties you require.</p>\n<p>For example, the following model has <em>two</em> <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>s \u2013 one that returns\nall objects, and one that returns only the books by Roald Dahl:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># First, define the Manager subclass.</span>\n<span class=\"k\">class</span> <span class=\"nc\">DahlBookManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">get_queryset</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">get_queryset</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">author</span><span class=\"o\">=</span><span class=\"s2\">&quot;Roald Dahl&quot;</span><span class=\"p\">)</span>\n\n\n<span class=\"c1\"># Then hook it into the Book model explicitly.</span>\n<span class=\"k\">class</span> <span class=\"nc\">Book</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">title</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n    <span class=\"n\">author</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n\n    <span class=\"n\">objects</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">()</span>  <span class=\"c1\"># The default manager.</span>\n    <span class=\"n\">dahl_objects</span> <span class=\"o\">=</span> <span class=\"n\">DahlBookManager</span><span class=\"p\">()</span>  <span class=\"c1\"># The Dahl-specific manager.</span>\n</pre></div>\n</div>\n<p>With this sample model, <code class=\"docutils literal notranslate\"><span class=\"pre\">Book.objects.all()</span></code> will return all books in the\ndatabase, but <code class=\"docutils literal notranslate\"><span class=\"pre\">Book.dahl_objects.all()</span></code> will only return the ones written by\nRoald Dahl.</p>\n<p>Because <code class=\"docutils literal notranslate\"><span class=\"pre\">get_queryset()</span></code> returns a <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> object, you can use\n<code class=\"docutils literal notranslate\"><span class=\"pre\">filter()</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">exclude()</span></code> and all the other <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> methods on it. So\nthese statements are all legal:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Book</span><span class=\"o\">.</span><span class=\"n\">dahl_objects</span><span class=\"o\">.</span><span class=\"n\">all</span><span class=\"p\">()</span>\n<span class=\"n\">Book</span><span class=\"o\">.</span><span class=\"n\">dahl_objects</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">title</span><span class=\"o\">=</span><span class=\"s2\">&quot;Matilda&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Book</span><span class=\"o\">.</span><span class=\"n\">dahl_objects</span><span class=\"o\">.</span><span class=\"n\">count</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>This example also pointed out another interesting technique: using multiple\nmanagers on the same model. You can attach as many <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager()</span></code> instances to\na model as you\u2019d like. This is a non-repetitive way to define common \u201cfilters\u201d\nfor your models.</p>\n<p>For example:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">AuthorManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">get_queryset</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">get_queryset</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">role</span><span class=\"o\">=</span><span class=\"s2\">&quot;A&quot;</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">EditorManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">get_queryset</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">get_queryset</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">role</span><span class=\"o\">=</span><span class=\"s2\">&quot;E&quot;</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Person</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">first_name</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n    <span class=\"n\">last_name</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n    <span class=\"n\">role</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span>\n        <span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">choices</span><span class=\"o\">=</span><span class=\"p\">[(</span><span class=\"s2\">&quot;A&quot;</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">&quot;Author&quot;</span><span class=\"p\">)),</span> <span class=\"p\">(</span><span class=\"s2\">&quot;E&quot;</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">&quot;Editor&quot;</span><span class=\"p\">))]</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">people</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">()</span>\n    <span class=\"n\">authors</span> <span class=\"o\">=</span> <span class=\"n\">AuthorManager</span><span class=\"p\">()</span>\n    <span class=\"n\">editors</span> <span class=\"o\">=</span> <span class=\"n\">EditorManager</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>This example allows you to request <code class=\"docutils literal notranslate\"><span class=\"pre\">Person.authors.all()</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">Person.editors.all()</span></code>,\nand <code class=\"docutils literal notranslate\"><span class=\"pre\">Person.people.all()</span></code>, yielding predictable results.</p>\n</div>\n<div class=\"section\" id=\"s-default-managers\">\n<span id=\"s-id3\"></span><span id=\"default-managers\"></span><span id=\"id3\"></span><h3>Default managers<a class=\"headerlink\" href=\"#default-managers\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"django.db.models.Model._default_manager\">\n<code class=\"sig-prename descclassname\"><span class=\"pre\">Model.</span></code><code class=\"sig-name descname\"><span class=\"pre\">_default_manager</span></code><a class=\"headerlink\" href=\"#django.db.models.Model._default_manager\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd></dd></dl>\n\n<p>If you use custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> objects, take note that the first <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>\nDjango encounters (in the order in which they\u2019re defined in the model) has a\nspecial status. Django interprets the first <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> defined in a class as\nthe \u201cdefault\u201d <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>, and several parts of Django (including\n<a class=\"reference internal\" href=\"../../../ref/django-admin/#django-admin-dumpdata\"><code class=\"xref std std-djadmin docutils literal notranslate\"><span class=\"pre\">dumpdata</span></code></a>) will use that <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> exclusively for that model. As a\nresult, it\u2019s a good idea to be careful in your choice of default manager in\norder to avoid a situation where overriding <code class=\"docutils literal notranslate\"><span class=\"pre\">get_queryset()</span></code> results in an\ninability to retrieve objects you\u2019d like to work with.</p>\n<p>You can specify a custom default manager using <a class=\"reference internal\" href=\"../../../ref/models/options/#django.db.models.Options.default_manager_name\" title=\"django.db.models.Options.default_manager_name\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Meta.default_manager_name</span></code></a>.</p>\n<p>If you\u2019re writing some code that must handle an unknown model, for example, in\na third-party app that implements a generic view, use this manager (or\n<a class=\"reference internal\" href=\"#django.db.models.Model._base_manager\" title=\"django.db.models.Model._base_manager\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">_base_manager</span></code></a>) rather than assuming the model has an <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code>\nmanager.</p>\n</div>\n<div class=\"section\" id=\"s-base-managers\">\n<span id=\"base-managers\"></span><h3>Base managers<a class=\"headerlink\" href=\"#base-managers\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"django.db.models.Model._base_manager\">\n<code class=\"sig-prename descclassname\"><span class=\"pre\">Model.</span></code><code class=\"sig-name descname\"><span class=\"pre\">_base_manager</span></code><a class=\"headerlink\" href=\"#django.db.models.Model._base_manager\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd></dd></dl>\n\n<div class=\"section\" id=\"s-using-managers-for-related-object-access\">\n<span id=\"s-managers-for-related-objects\"></span><span id=\"using-managers-for-related-object-access\"></span><span id=\"managers-for-related-objects\"></span><h4>Using managers for related object access<a class=\"headerlink\" href=\"#using-managers-for-related-object-access\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>By default, Django uses an instance of the <code class=\"docutils literal notranslate\"><span class=\"pre\">Model._base_manager</span></code> manager\nclass when accessing related objects (i.e. <code class=\"docutils literal notranslate\"><span class=\"pre\">choice.question</span></code>), not the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">_default_manager</span></code> on the related object. This is because Django needs to be\nable to retrieve the related object, even if it would otherwise be filtered out\n(and hence be inaccessible) by the default manager.</p>\n<p>If the normal base manager class (<a class=\"reference internal\" href=\"#django.db.models.Manager\" title=\"django.db.models.Manager\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">django.db.models.Manager</span></code></a>) isn\u2019t\nappropriate for your circumstances, you can tell Django which class to use by\nsetting <a class=\"reference internal\" href=\"../../../ref/models/options/#django.db.models.Options.base_manager_name\" title=\"django.db.models.Options.base_manager_name\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Meta.base_manager_name</span></code></a>.</p>\n<p>Base managers aren\u2019t used when querying on related models, or when\n<a class=\"reference internal\" href=\"../queries/#backwards-related-objects\"><span class=\"std std-ref\">accessing a one-to-many or many-to-many relationship</span></a>. For example, if the <code class=\"docutils literal notranslate\"><span class=\"pre\">Question</span></code> model\n<a class=\"reference internal\" href=\"../../../intro/tutorial02/#creating-models\"><span class=\"std std-ref\">from the tutorial</span></a> had a <code class=\"docutils literal notranslate\"><span class=\"pre\">deleted</span></code> field and a base\nmanager that filters out instances with <code class=\"docutils literal notranslate\"><span class=\"pre\">deleted=True</span></code>, a queryset like\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Choice.objects.filter(question__name__startswith='What')</span></code> would include\nchoices related to deleted questions.</p>\n</div>\n<div class=\"section\" id=\"s-don-t-filter-away-any-results-in-this-type-of-manager-subclass\">\n<span id=\"don-t-filter-away-any-results-in-this-type-of-manager-subclass\"></span><h4>Don\u2019t filter away any results in this type of manager subclass<a class=\"headerlink\" href=\"#don-t-filter-away-any-results-in-this-type-of-manager-subclass\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>This manager is used to access objects that are related to from some other\nmodel. In those situations, Django has to be able to see all the objects for\nthe model it is fetching, so that <em>anything</em> which is referred to can be\nretrieved.</p>\n<p>Therefore, you should not override <code class=\"docutils literal notranslate\"><span class=\"pre\">get_queryset()</span></code> to filter out any rows.\nIf you do so, Django will return incomplete results.</p>\n</div>\n</div>\n<div class=\"section\" id=\"s-calling-custom-queryset-methods-from-the-manager\">\n<span id=\"s-calling-custom-queryset-methods-from-manager\"></span><span id=\"calling-custom-queryset-methods-from-the-manager\"></span><span id=\"calling-custom-queryset-methods-from-manager\"></span><h3>Calling custom <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> methods from the manager<a class=\"headerlink\" href=\"#calling-custom-queryset-methods-from-the-manager\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>While most methods from the standard <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> are accessible directly from\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>, this is only the case for the extra methods defined on a\ncustom <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> if you also implement them on the <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">PersonQuerySet</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">QuerySet</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">authors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">role</span><span class=\"o\">=</span><span class=\"s2\">&quot;A&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">editors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">role</span><span class=\"o\">=</span><span class=\"s2\">&quot;E&quot;</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">PersonManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">get_queryset</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">PersonQuerySet</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">using</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_db</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">authors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_queryset</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">authors</span><span class=\"p\">()</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">editors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_queryset</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">editors</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Person</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">first_name</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n    <span class=\"n\">last_name</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span><span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n    <span class=\"n\">role</span> <span class=\"o\">=</span> <span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">CharField</span><span class=\"p\">(</span>\n        <span class=\"n\">max_length</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">choices</span><span class=\"o\">=</span><span class=\"p\">[(</span><span class=\"s2\">&quot;A&quot;</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">&quot;Author&quot;</span><span class=\"p\">)),</span> <span class=\"p\">(</span><span class=\"s2\">&quot;E&quot;</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">&quot;Editor&quot;</span><span class=\"p\">))]</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">people</span> <span class=\"o\">=</span> <span class=\"n\">PersonManager</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>This example allows you to call both <code class=\"docutils literal notranslate\"><span class=\"pre\">authors()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">editors()</span></code> directly from\nthe manager <code class=\"docutils literal notranslate\"><span class=\"pre\">Person.people</span></code>.</p>\n</div>\n<div class=\"section\" id=\"s-creating-a-manager-with-queryset-methods\">\n<span id=\"s-create-manager-with-queryset-methods\"></span><span id=\"creating-a-manager-with-queryset-methods\"></span><span id=\"create-manager-with-queryset-methods\"></span><h3>Creating a manager with <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> methods<a class=\"headerlink\" href=\"#creating-a-manager-with-queryset-methods\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>In lieu of the above approach which requires duplicating methods on both the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> and the <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>, <a class=\"reference internal\" href=\"../../../ref/models/querysets/#django.db.models.query.QuerySet.as_manager\" title=\"django.db.models.query.QuerySet.as_manager\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">QuerySet.as_manager()</span></code></a> can be used to create an instance\nof <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> with a copy of a custom <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code>\u2019s methods:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">Person</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"o\">...</span>\n    <span class=\"n\">people</span> <span class=\"o\">=</span> <span class=\"n\">PersonQuerySet</span><span class=\"o\">.</span><span class=\"n\">as_manager</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> instance created by <a class=\"reference internal\" href=\"../../../ref/models/querysets/#django.db.models.query.QuerySet.as_manager\" title=\"django.db.models.query.QuerySet.as_manager\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">QuerySet.as_manager()</span></code></a> will be virtually\nidentical to the <code class=\"docutils literal notranslate\"><span class=\"pre\">PersonManager</span></code> from the previous example.</p>\n<p>Not every <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> method makes sense at the <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> level; for\ninstance we intentionally prevent the <a class=\"reference internal\" href=\"../../../ref/models/querysets/#django.db.models.query.QuerySet.delete\" title=\"django.db.models.query.QuerySet.delete\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">QuerySet.delete()</span></code></a> method from being copied onto\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> class.</p>\n<p>Methods are copied according to the following rules:</p>\n<ul class=\"simple\">\n<li>Public methods are copied by default.</li>\n<li>Private methods (starting with an underscore) are not copied by default.</li>\n<li>Methods with a <code class=\"docutils literal notranslate\"><span class=\"pre\">queryset_only</span></code> attribute set to <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code> are always copied.</li>\n<li>Methods with a <code class=\"docutils literal notranslate\"><span class=\"pre\">queryset_only</span></code> attribute set to <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> are never copied.</li>\n</ul>\n<p>For example:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">CustomQuerySet</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">QuerySet</span><span class=\"p\">):</span>\n    <span class=\"c1\"># Available on both Manager and QuerySet.</span>\n    <span class=\"k\">def</span> <span class=\"nf\">public_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n\n    <span class=\"c1\"># Available only on QuerySet.</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_private_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n\n    <span class=\"c1\"># Available only on QuerySet.</span>\n    <span class=\"k\">def</span> <span class=\"nf\">opted_out_public_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n\n    <span class=\"n\">opted_out_public_method</span><span class=\"o\">.</span><span class=\"n\">queryset_only</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n\n    <span class=\"c1\"># Available on both Manager and QuerySet.</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_opted_in_private_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n\n    <span class=\"n\">_opted_in_private_method</span><span class=\"o\">.</span><span class=\"n\">queryset_only</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n</pre></div>\n</div>\n<div class=\"section\" id=\"s-from-queryset\">\n<span id=\"from-queryset\"></span><h4><code class=\"docutils literal notranslate\"><span class=\"pre\">from_queryset()</span></code><a class=\"headerlink\" href=\"#from-queryset\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"django.db.models.from_queryset\">\n<em class=\"property\"><span class=\"pre\">classmethod</span><span class=\"w\"> </span></em><code class=\"sig-name descname\"><span class=\"pre\">from_queryset</span></code>(<em><span class=\"n\"><span class=\"pre\">queryset_class</span></span></em>)<a class=\"headerlink\" href=\"#django.db.models.from_queryset\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd></dd></dl>\n\n<p>For advanced usage you might want both a custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> and a custom\n<code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code>. You can do that by calling <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager.from_queryset()</span></code> which\nreturns a <em>subclass</em> of your base <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> with a copy of the custom\n<code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> methods:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">CustomManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Manager</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">manager_only_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">CustomQuerySet</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">QuerySet</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">manager_and_queryset_method</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">MyModel</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">objects</span> <span class=\"o\">=</span> <span class=\"n\">CustomManager</span><span class=\"o\">.</span><span class=\"n\">from_queryset</span><span class=\"p\">(</span><span class=\"n\">CustomQuerySet</span><span class=\"p\">)()</span>\n</pre></div>\n</div>\n<p>You may also store the generated class into a variable:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">MyManager</span> <span class=\"o\">=</span> <span class=\"n\">CustomManager</span><span class=\"o\">.</span><span class=\"n\">from_queryset</span><span class=\"p\">(</span><span class=\"n\">CustomQuerySet</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">MyModel</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">objects</span> <span class=\"o\">=</span> <span class=\"n\">MyManager</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"s-custom-managers-and-model-inheritance\">\n<span id=\"s-custom-managers-and-inheritance\"></span><span id=\"custom-managers-and-model-inheritance\"></span><span id=\"custom-managers-and-inheritance\"></span><h3>Custom managers and model inheritance<a class=\"headerlink\" href=\"#custom-managers-and-model-inheritance\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Here\u2019s how Django handles custom managers and <a class=\"reference internal\" href=\"../models/#model-inheritance\"><span class=\"std std-ref\">model inheritance</span></a>:</p>\n<ol class=\"arabic simple\">\n<li>Managers from base classes are always inherited by the child class,\nusing Python\u2019s normal name resolution order (names on the child\nclass override all others; then come names on the first parent class,\nand so on).</li>\n<li>If no managers are declared on a model and/or its parents, Django\nautomatically creates the <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code> manager.</li>\n<li>The default manager on a class is either the one chosen with\n<a class=\"reference internal\" href=\"../../../ref/models/options/#django.db.models.Options.default_manager_name\" title=\"django.db.models.Options.default_manager_name\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Meta.default_manager_name</span></code></a>, or the first manager\ndeclared on the model, or the default manager of the first parent model.</li>\n</ol>\n<p>These rules provide the necessary flexibility if you want to install a\ncollection of custom managers on a group of models, via an abstract base\nclass, but still customize the default manager. For example, suppose you have\nthis base class:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">AbstractBase</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"n\">objects</span> <span class=\"o\">=</span> <span class=\"n\">CustomManager</span><span class=\"p\">()</span>\n\n    <span class=\"k\">class</span> <span class=\"nc\">Meta</span><span class=\"p\">:</span>\n        <span class=\"n\">abstract</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n</pre></div>\n</div>\n<p>If you use this directly in a subclass, <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code> will be the default\nmanager if you declare no managers in the base class:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">ChildA</span><span class=\"p\">(</span><span class=\"n\">AbstractBase</span><span class=\"p\">):</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"c1\"># This class has CustomManager as the default manager.</span>\n    <span class=\"k\">pass</span>\n</pre></div>\n</div>\n<p>If you want to inherit from <code class=\"docutils literal notranslate\"><span class=\"pre\">AbstractBase</span></code>, but provide a different default\nmanager, you can provide the default manager on the child class:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">ChildB</span><span class=\"p\">(</span><span class=\"n\">AbstractBase</span><span class=\"p\">):</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"c1\"># An explicit default manager.</span>\n    <span class=\"n\">default_manager</span> <span class=\"o\">=</span> <span class=\"n\">OtherManager</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Here, <code class=\"docutils literal notranslate\"><span class=\"pre\">default_manager</span></code> is the default. The <code class=\"docutils literal notranslate\"><span class=\"pre\">objects</span></code> manager is\nstill available, since it\u2019s inherited, but isn\u2019t used as the default.</p>\n<p>Finally for this example, suppose you want to add extra managers to the child\nclass, but still use the default from <code class=\"docutils literal notranslate\"><span class=\"pre\">AbstractBase</span></code>. You can\u2019t add the new\nmanager directly in the child class, as that would override the default and you would\nhave to also explicitly include all the managers from the abstract base class.\nThe solution is to put the extra managers in another base class and introduce\nit into the inheritance hierarchy <em>after</em> the defaults:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span> <span class=\"nc\">ExtraManager</span><span class=\"p\">(</span><span class=\"n\">models</span><span class=\"o\">.</span><span class=\"n\">Model</span><span class=\"p\">):</span>\n    <span class=\"n\">extra_manager</span> <span class=\"o\">=</span> <span class=\"n\">OtherManager</span><span class=\"p\">()</span>\n\n    <span class=\"k\">class</span> <span class=\"nc\">Meta</span><span class=\"p\">:</span>\n        <span class=\"n\">abstract</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">ChildC</span><span class=\"p\">(</span><span class=\"n\">AbstractBase</span><span class=\"p\">,</span> <span class=\"n\">ExtraManager</span><span class=\"p\">):</span>\n    <span class=\"c1\"># ...</span>\n    <span class=\"c1\"># Default manager is CustomManager, but OtherManager is</span>\n    <span class=\"c1\"># also available via the &quot;extra_manager&quot; attribute.</span>\n    <span class=\"k\">pass</span>\n</pre></div>\n</div>\n<p>Note that while you can <em>define</em> a custom manager on the abstract model, you\ncan\u2019t <em>invoke</em> any methods using the abstract model. That is:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ClassA</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">do_something</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>is legal, but:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">AbstractBase</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">do_something</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>will raise an exception. This is because managers are intended to encapsulate\nlogic for managing collections of objects. Since you can\u2019t have a collection of\nabstract objects, it doesn\u2019t make sense to be managing them. If you have\nfunctionality that applies to the abstract model, you should put that functionality\nin a <code class=\"docutils literal notranslate\"><span class=\"pre\">staticmethod</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">classmethod</span></code> on the abstract model.</p>\n</div>\n<div class=\"section\" id=\"s-implementation-concerns\">\n<span id=\"implementation-concerns\"></span><h3>Implementation concerns<a class=\"headerlink\" href=\"#implementation-concerns\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Whatever features you add to your custom <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>, it must be\npossible to make a shallow copy of a <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> instance; i.e., the\nfollowing code must work:</p>\n<div class=\"highlight-pycon notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">copy</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">manager</span> <span class=\"o\">=</span> <span class=\"n\">MyManager</span><span class=\"p\">()</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">my_copy</span> <span class=\"o\">=</span> <span class=\"n\">copy</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Django makes shallow copies of manager objects during certain queries;\nif your Manager cannot be copied, those queries will fail.</p>\n<p>This won\u2019t be an issue for most custom managers. If you are just\nadding simple methods to your <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code>, it is unlikely that you\nwill inadvertently make instances of your <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> uncopyable.\nHowever, if you\u2019re overriding <code class=\"docutils literal notranslate\"><span class=\"pre\">__getattr__</span></code> or some other private\nmethod of your <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> object that controls object state, you\nshould ensure that you don\u2019t affect the ability of your <code class=\"docutils literal notranslate\"><span class=\"pre\">Manager</span></code> to\nbe copied.</p>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["topics/db/sql", "Performing raw SQL queries", "N", "next"], ["topics/db/search", "Search", "P", "previous"]], "sourcename": "topics/db/managers.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Managers</a><ul>\n<li><a class=\"reference internal\" href=\"#manager-names\">Manager names</a></li>\n<li><a class=\"reference internal\" href=\"#custom-managers\">Custom managers</a><ul>\n<li><a class=\"reference internal\" href=\"#adding-extra-manager-methods\">Adding extra manager methods</a></li>\n<li><a class=\"reference internal\" href=\"#modifying-a-manager-s-initial-queryset\">Modifying a manager\u2019s initial <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#default-managers\">Default managers</a></li>\n<li><a class=\"reference internal\" href=\"#base-managers\">Base managers</a><ul>\n<li><a class=\"reference internal\" href=\"#using-managers-for-related-object-access\">Using managers for related object access</a></li>\n<li><a class=\"reference internal\" href=\"#don-t-filter-away-any-results-in-this-type-of-manager-subclass\">Don\u2019t filter away any results in this type of manager subclass</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#calling-custom-queryset-methods-from-the-manager\">Calling custom <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> methods from the manager</a></li>\n<li><a class=\"reference internal\" href=\"#creating-a-manager-with-queryset-methods\">Creating a manager with <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> methods</a><ul>\n<li><a class=\"reference internal\" href=\"#from-queryset\"><code class=\"docutils literal notranslate\"><span class=\"pre\">from_queryset()</span></code></a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#custom-managers-and-model-inheritance\">Custom managers and model inheritance</a></li>\n<li><a class=\"reference internal\" href=\"#implementation-concerns\">Implementation concerns</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".txt", "current_page_name": "topics/db/managers", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}