{"parents": [{"link": "../../../", "title": "Module code"}, {"link": "../../", "title": "django"}], "title": "django.template.context_processors", "body": "<h1>Source code for django.template.context_processors</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">A set of request processors that return dictionaries to be merged into a</span>\n<span class=\"sd\">template context. Each function takes the request object as its only parameter</span>\n<span class=\"sd\">and returns a dictionary to add to the context.</span>\n\n<span class=\"sd\">These are referenced from the &#39;context_processors&#39; option of the configuration</span>\n<span class=\"sd\">of a DjangoTemplates backend and used by RequestContext.</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">itertools</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">django.conf</span> <span class=\"kn\">import</span> <span class=\"n\">settings</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.middleware.csrf</span> <span class=\"kn\">import</span> <span class=\"n\">get_token</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.utils.functional</span> <span class=\"kn\">import</span> <span class=\"n\">SimpleLazyObject</span><span class=\"p\">,</span> <span class=\"n\">lazy</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">csrf</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Context processor that provides a CSRF token, or the string &#39;NOTPROVIDED&#39; if</span>\n<span class=\"sd\">    it has not been provided by either a view decorator or the middleware</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_val</span><span class=\"p\">():</span>\n        <span class=\"n\">token</span> <span class=\"o\">=</span> <span class=\"n\">get_token</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">token</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"c1\"># In order to be able to provide debugging info in the</span>\n            <span class=\"c1\"># case of misconfiguration, we use a sentinel value</span>\n            <span class=\"c1\"># instead of returning an empty dict.</span>\n            <span class=\"k\">return</span> <span class=\"s2\">&quot;NOTPROVIDED&quot;</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"n\">token</span>\n\n    <span class=\"k\">return</span> <span class=\"p\">{</span><span class=\"s2\">&quot;csrf_token&quot;</span><span class=\"p\">:</span> <span class=\"n\">SimpleLazyObject</span><span class=\"p\">(</span><span class=\"n\">_get_val</span><span class=\"p\">)}</span>\n\n\n<div class=\"viewcode-block\" id=\"debug\"><a class=\"viewcode-back\" href=\"../../../../ref/templates/api/#django.template.context_processors.debug\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">debug</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Return context variables helpful for debugging.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">context_extras</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n    <span class=\"k\">if</span> <span class=\"n\">settings</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span> <span class=\"ow\">and</span> <span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">META</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s2\">&quot;REMOTE_ADDR&quot;</span><span class=\"p\">)</span> <span class=\"ow\">in</span> <span class=\"n\">settings</span><span class=\"o\">.</span><span class=\"n\">INTERNAL_IPS</span><span class=\"p\">:</span>\n        <span class=\"n\">context_extras</span><span class=\"p\">[</span><span class=\"s2\">&quot;debug&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">django.db</span> <span class=\"kn\">import</span> <span class=\"n\">connections</span>\n\n        <span class=\"c1\"># Return a lazy reference that computes connection.queries on access,</span>\n        <span class=\"c1\"># to ensure it contains queries triggered after this function runs.</span>\n        <span class=\"n\">context_extras</span><span class=\"p\">[</span><span class=\"s2\">&quot;sql_queries&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">lazy</span><span class=\"p\">(</span>\n            <span class=\"k\">lambda</span><span class=\"p\">:</span> <span class=\"nb\">list</span><span class=\"p\">(</span>\n                <span class=\"n\">itertools</span><span class=\"o\">.</span><span class=\"n\">chain</span><span class=\"o\">.</span><span class=\"n\">from_iterable</span><span class=\"p\">(</span>\n                    <span class=\"n\">connections</span><span class=\"p\">[</span><span class=\"n\">x</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">queries</span> <span class=\"k\">for</span> <span class=\"n\">x</span> <span class=\"ow\">in</span> <span class=\"n\">connections</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">),</span>\n            <span class=\"nb\">list</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">context_extras</span></div>\n\n\n<div class=\"viewcode-block\" id=\"i18n\"><a class=\"viewcode-back\" href=\"../../../../ref/templates/api/#django.template.context_processors.i18n\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">i18n</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">django.utils</span> <span class=\"kn\">import</span> <span class=\"n\">translation</span>\n\n    <span class=\"k\">return</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;LANGUAGES&quot;</span><span class=\"p\">:</span> <span class=\"n\">settings</span><span class=\"o\">.</span><span class=\"n\">LANGUAGES</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;LANGUAGE_CODE&quot;</span><span class=\"p\">:</span> <span class=\"n\">translation</span><span class=\"o\">.</span><span class=\"n\">get_language</span><span class=\"p\">(),</span>\n        <span class=\"s2\">&quot;LANGUAGE_BIDI&quot;</span><span class=\"p\">:</span> <span class=\"n\">translation</span><span class=\"o\">.</span><span class=\"n\">get_language_bidi</span><span class=\"p\">(),</span>\n    <span class=\"p\">}</span></div>\n\n\n<div class=\"viewcode-block\" id=\"tz\"><a class=\"viewcode-back\" href=\"../../../../ref/templates/api/#django.template.context_processors.tz\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">tz</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">django.utils</span> <span class=\"kn\">import</span> <span class=\"n\">timezone</span>\n\n    <span class=\"k\">return</span> <span class=\"p\">{</span><span class=\"s2\">&quot;TIME_ZONE&quot;</span><span class=\"p\">:</span> <span class=\"n\">timezone</span><span class=\"o\">.</span><span class=\"n\">get_current_timezone_name</span><span class=\"p\">()}</span></div>\n\n\n<div class=\"viewcode-block\" id=\"static\"><a class=\"viewcode-back\" href=\"../../../../ref/templates/api/#django.template.context_processors.static\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">static</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Add static-related context variables to the context.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">return</span> <span class=\"p\">{</span><span class=\"s2\">&quot;STATIC_URL&quot;</span><span class=\"p\">:</span> <span class=\"n\">settings</span><span class=\"o\">.</span><span class=\"n\">STATIC_URL</span><span class=\"p\">}</span></div>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">media</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Add media-related context variables to the context.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"k\">return</span> <span class=\"p\">{</span><span class=\"s2\">&quot;MEDIA_URL&quot;</span><span class=\"p\">:</span> <span class=\"n\">settings</span><span class=\"o\">.</span><span class=\"n\">MEDIA_URL</span><span class=\"p\">}</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">request</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"p\">{</span><span class=\"s2\">&quot;request&quot;</span><span class=\"p\">:</span> <span class=\"n\">request</span><span class=\"p\">}</span>\n</pre></div>", "current_page_name": "_modules/django/template/context_processors", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}