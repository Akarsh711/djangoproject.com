{"parents": [{"link": "../../../../", "title": "Module code"}, {"link": "../../../", "title": "django"}], "title": "django.contrib.postgres.validators", "body": "<h1>Source code for django.contrib.postgres.validators</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">from</span> <span class=\"nn\">django.core.exceptions</span> <span class=\"kn\">import</span> <span class=\"n\">ValidationError</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.core.validators</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">MaxLengthValidator</span><span class=\"p\">,</span>\n    <span class=\"n\">MaxValueValidator</span><span class=\"p\">,</span>\n    <span class=\"n\">MinLengthValidator</span><span class=\"p\">,</span>\n    <span class=\"n\">MinValueValidator</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.utils.deconstruct</span> <span class=\"kn\">import</span> <span class=\"n\">deconstructible</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.utils.translation</span> <span class=\"kn\">import</span> <span class=\"n\">gettext_lazy</span> <span class=\"k\">as</span> <span class=\"n\">_</span>\n<span class=\"kn\">from</span> <span class=\"nn\">django.utils.translation</span> <span class=\"kn\">import</span> <span class=\"n\">ngettext_lazy</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">ArrayMaxLengthValidator</span><span class=\"p\">(</span><span class=\"n\">MaxLengthValidator</span><span class=\"p\">):</span>\n    <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">ngettext_lazy</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;List contains </span><span class=\"si\">%(show_value)d</span><span class=\"s2\"> item, it should contain no more than &quot;</span>\n        <span class=\"s2\">&quot;</span><span class=\"si\">%(limit_value)d</span><span class=\"s2\">.&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;List contains </span><span class=\"si\">%(show_value)d</span><span class=\"s2\"> items, it should contain no more than &quot;</span>\n        <span class=\"s2\">&quot;</span><span class=\"si\">%(limit_value)d</span><span class=\"s2\">.&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;limit_value&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">ArrayMinLengthValidator</span><span class=\"p\">(</span><span class=\"n\">MinLengthValidator</span><span class=\"p\">):</span>\n    <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">ngettext_lazy</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;List contains </span><span class=\"si\">%(show_value)d</span><span class=\"s2\"> item, it should contain no fewer than &quot;</span>\n        <span class=\"s2\">&quot;</span><span class=\"si\">%(limit_value)d</span><span class=\"s2\">.&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;List contains </span><span class=\"si\">%(show_value)d</span><span class=\"s2\"> items, it should contain no fewer than &quot;</span>\n        <span class=\"s2\">&quot;</span><span class=\"si\">%(limit_value)d</span><span class=\"s2\">.&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;limit_value&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"KeysValidator\"><a class=\"viewcode-back\" href=\"../../../../../ref/contrib/postgres/validators/#django.contrib.postgres.validators.KeysValidator\">[docs]</a><span class=\"nd\">@deconstructible</span>\n<span class=\"k\">class</span> <span class=\"nc\">KeysValidator</span><span class=\"p\">:</span>\n    <span class=\"sd\">&quot;&quot;&quot;A validator designed for HStore to require/restrict keys.&quot;&quot;&quot;</span>\n\n    <span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;missing_keys&quot;</span><span class=\"p\">:</span> <span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">&quot;Some keys were missing: </span><span class=\"si\">%(keys)s</span><span class=\"s2\">&quot;</span><span class=\"p\">),</span>\n        <span class=\"s2\">&quot;extra_keys&quot;</span><span class=\"p\">:</span> <span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">&quot;Some unknown keys were provided: </span><span class=\"si\">%(keys)s</span><span class=\"s2\">&quot;</span><span class=\"p\">),</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">strict</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">keys</span><span class=\"p\">,</span> <span class=\"n\">strict</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">messages</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">keys</span> <span class=\"o\">=</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">keys</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">strict</span> <span class=\"o\">=</span> <span class=\"n\">strict</span>\n        <span class=\"k\">if</span> <span class=\"n\">messages</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">messages</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"o\">**</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">messages</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">messages</span><span class=\"p\">}</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__call__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">value</span><span class=\"p\">):</span>\n        <span class=\"n\">keys</span> <span class=\"o\">=</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">)</span>\n        <span class=\"n\">missing_keys</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">keys</span> <span class=\"o\">-</span> <span class=\"n\">keys</span>\n        <span class=\"k\">if</span> <span class=\"n\">missing_keys</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">ValidationError</span><span class=\"p\">(</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">messages</span><span class=\"p\">[</span><span class=\"s2\">&quot;missing_keys&quot;</span><span class=\"p\">],</span>\n                <span class=\"n\">code</span><span class=\"o\">=</span><span class=\"s2\">&quot;missing_keys&quot;</span><span class=\"p\">,</span>\n                <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">&quot;keys&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">missing_keys</span><span class=\"p\">)},</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">strict</span><span class=\"p\">:</span>\n            <span class=\"n\">extra_keys</span> <span class=\"o\">=</span> <span class=\"n\">keys</span> <span class=\"o\">-</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">keys</span>\n            <span class=\"k\">if</span> <span class=\"n\">extra_keys</span><span class=\"p\">:</span>\n                <span class=\"k\">raise</span> <span class=\"n\">ValidationError</span><span class=\"p\">(</span>\n                    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">messages</span><span class=\"p\">[</span><span class=\"s2\">&quot;extra_keys&quot;</span><span class=\"p\">],</span>\n                    <span class=\"n\">code</span><span class=\"o\">=</span><span class=\"s2\">&quot;extra_keys&quot;</span><span class=\"p\">,</span>\n                    <span class=\"n\">params</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">&quot;keys&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">extra_keys</span><span class=\"p\">)},</span>\n                <span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__eq__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">other</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"p\">(</span>\n            <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">other</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"vm\">__class__</span><span class=\"p\">)</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">keys</span> <span class=\"o\">==</span> <span class=\"n\">other</span><span class=\"o\">.</span><span class=\"n\">keys</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">messages</span> <span class=\"o\">==</span> <span class=\"n\">other</span><span class=\"o\">.</span><span class=\"n\">messages</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">strict</span> <span class=\"o\">==</span> <span class=\"n\">other</span><span class=\"o\">.</span><span class=\"n\">strict</span>\n        <span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"RangeMaxValueValidator\"><a class=\"viewcode-back\" href=\"../../../../../ref/contrib/postgres/validators/#django.contrib.postgres.validators.RangeMaxValueValidator\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">RangeMaxValueValidator</span><span class=\"p\">(</span><span class=\"n\">MaxValueValidator</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">compare</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">upper</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span> <span class=\"ow\">or</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">upper</span> <span class=\"o\">&gt;</span> <span class=\"n\">b</span>\n\n    <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">_</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;Ensure that the upper bound of the range is not greater than </span><span class=\"si\">%(limit_value)s</span><span class=\"s2\">.&quot;</span>\n    <span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"RangeMinValueValidator\"><a class=\"viewcode-back\" href=\"../../../../../ref/contrib/postgres/validators/#django.contrib.postgres.validators.RangeMinValueValidator\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">RangeMinValueValidator</span><span class=\"p\">(</span><span class=\"n\">MinValueValidator</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"nf\">compare</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">lower</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span> <span class=\"ow\">or</span> <span class=\"n\">a</span><span class=\"o\">.</span><span class=\"n\">lower</span> <span class=\"o\">&lt;</span> <span class=\"n\">b</span>\n\n    <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"n\">_</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;Ensure that the lower bound of the range is not less than </span><span class=\"si\">%(limit_value)s</span><span class=\"s2\">.&quot;</span>\n    <span class=\"p\">)</span></div>\n</pre></div>", "current_page_name": "_modules/django/contrib/postgres/validators", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}
