{"parents": [{"link": "../", "title": "Release notes"}], "prev": {"link": "../3.0.1/", "title": "Django 3.0.1 release notes"}, "next": {"link": "../2.2.28/", "title": "Django 2.2.28 release notes"}, "title": "Django 3.0 release notes", "meta": {}, "body": "<div class=\"section\" id=\"s-django-3-0-release-notes\">\n<span id=\"django-3-0-release-notes\"></span><h1>Django 3.0 release notes<a class=\"headerlink\" href=\"#django-3-0-release-notes\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p><em>December 2, 2019</em></p>\n<p>Welcome to Django 3.0!</p>\n<p>These release notes cover the <a class=\"reference internal\" href=\"#whats-new-3-0\"><span class=\"std std-ref\">new features</span></a>, as well as\nsome <a class=\"reference internal\" href=\"#backwards-incompatible-3-0\"><span class=\"std std-ref\">backwards incompatible changes</span></a> you\u2019ll\nwant to be aware of when upgrading from Django 2.2 or earlier. We\u2019ve\n<a class=\"reference internal\" href=\"#removed-features-3-0\"><span class=\"std std-ref\">dropped some features</span></a> that have reached the end of\ntheir deprecation cycle, and we\u2019ve <a class=\"reference internal\" href=\"#deprecated-features-3-0\"><span class=\"std std-ref\">begun the deprecation process for\nsome features</span></a>.</p>\n<p>See the <a class=\"reference internal\" href=\"../../howto/upgrade-version/\"><span class=\"doc\">How to upgrade Django to a newer version</span></a> guide if you\u2019re updating an existing\nproject.</p>\n<div class=\"section\" id=\"s-python-compatibility\">\n<span id=\"python-compatibility\"></span><h2>Python compatibility<a class=\"headerlink\" href=\"#python-compatibility\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Django 3.0 supports Python 3.6, 3.7, 3.8, and 3.9 (as of 3.0.11). We <strong>highly\nrecommend</strong> and only officially support the latest release of each series.</p>\n<p>The Django 2.2.x series is the last to support Python 3.5.</p>\n</div>\n<div class=\"section\" id=\"s-third-party-library-support-for-older-version-of-django\">\n<span id=\"third-party-library-support-for-older-version-of-django\"></span><h2>Third-party library support for older version of Django<a class=\"headerlink\" href=\"#third-party-library-support-for-older-version-of-django\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Following the release of Django 3.0, we suggest that third-party app authors\ndrop support for all versions of Django prior to 2.2. At that time, you should\nbe able to run your package\u2019s tests using <code class=\"docutils literal notranslate\"><span class=\"pre\">python</span> <span class=\"pre\">-Wd</span></code> so that deprecation\nwarnings appear. After making the deprecation warning fixes, your app should be\ncompatible with Django 3.0.</p>\n</div>\n<div class=\"section\" id=\"s-what-s-new-in-django-3-0\">\n<span id=\"s-whats-new-3-0\"></span><span id=\"what-s-new-in-django-3-0\"></span><span id=\"whats-new-3-0\"></span><h2>What\u2019s new in Django 3.0<a class=\"headerlink\" href=\"#what-s-new-in-django-3-0\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"s-mariadb-support\">\n<span id=\"mariadb-support\"></span><h3>MariaDB support<a class=\"headerlink\" href=\"#mariadb-support\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Django now officially supports <a class=\"reference external\" href=\"https://mariadb.org/\">MariaDB</a> 10.1 and\nhigher. See <a class=\"reference internal\" href=\"../../ref/databases/#mariadb-notes\"><span class=\"std std-ref\">MariaDB notes</span></a> for more details.</p>\n</div>\n<div class=\"section\" id=\"s-asgi-support\">\n<span id=\"asgi-support\"></span><h3>ASGI support<a class=\"headerlink\" href=\"#asgi-support\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Django 3.0 begins our journey to making Django fully async-capable by providing\nsupport for running as an <a class=\"reference external\" href=\"https://asgi.readthedocs.io/\">ASGI</a> application.</p>\n<p>This is in addition to our existing WSGI support. Django intends to support\nboth for the foreseeable future. Async features will only be available to\napplications that run under ASGI, however.</p>\n<p>At this stage async support only applies to the outer ASGI application.\nInternally everything remains synchronous. Asynchronous middleware, views, etc.\nare not yet supported. You can, however, use ASGI middleware around Django\u2019s\napplication, allowing you to combine Django with other ASGI frameworks.</p>\n<p>There is no need to switch your applications over unless you want to start\nexperimenting with asynchronous code, but we have\n<a class=\"reference internal\" href=\"../../howto/deployment/asgi/\"><span class=\"doc\">documentation on deploying with ASGI</span></a> if\nyou want to learn more.</p>\n<p>Note that as a side-effect of this change, Django is now aware of asynchronous\nevent loops and will block you calling code marked as \u201casync unsafe\u201d - such as\nORM operations - from an asynchronous context. If you were using Django from\nasync code before, this may trigger if you were doing it incorrectly. If you\nsee a <code class=\"docutils literal notranslate\"><span class=\"pre\">SynchronousOnlyOperation</span></code> error, then closely examine your code and\nmove any database operations to be in a synchronous child thread.</p>\n</div>\n<div class=\"section\" id=\"s-exclusion-constraints-on-postgresql\">\n<span id=\"exclusion-constraints-on-postgresql\"></span><h3>Exclusion constraints on PostgreSQL<a class=\"headerlink\" href=\"#exclusion-constraints-on-postgresql\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The new <a class=\"reference internal\" href=\"../../ref/contrib/postgres/constraints/#django.contrib.postgres.constraints.ExclusionConstraint\" title=\"django.contrib.postgres.constraints.ExclusionConstraint\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ExclusionConstraint</span></code></a> class\nenable adding exclusion constraints on PostgreSQL. Constraints are added to\nmodels using the\n<a class=\"reference internal\" href=\"../../ref/models/options/#django.db.models.Options.constraints\" title=\"django.db.models.Options.constraints\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Meta.constraints</span></code></a> option.</p>\n</div>\n<div class=\"section\" id=\"s-filter-expressions\">\n<span id=\"filter-expressions\"></span><h3>Filter expressions<a class=\"headerlink\" href=\"#filter-expressions\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Expressions that output <a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.BooleanField\" title=\"django.db.models.BooleanField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">BooleanField</span></code></a> may now be\nused directly in <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet</span></code> filters, without having to first annotate and\nthen filter against the annotation.</p>\n</div>\n<div class=\"section\" id=\"s-enumerations-for-model-field-choices\">\n<span id=\"enumerations-for-model-field-choices\"></span><h3>Enumerations for model field choices<a class=\"headerlink\" href=\"#enumerations-for-model-field-choices\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Custom enumeration types <code class=\"docutils literal notranslate\"><span class=\"pre\">TextChoices</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">IntegerChoices</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">Choices</span></code>\nare now available as a way to define <a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.Field.choices\" title=\"django.db.models.Field.choices\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Field.choices</span></code></a>. <code class=\"docutils literal notranslate\"><span class=\"pre\">TextChoices</span></code>\nand <code class=\"docutils literal notranslate\"><span class=\"pre\">IntegerChoices</span></code> types are provided for text and integer fields. The\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Choices</span></code> class allows defining a compatible enumeration for other concrete\ndata types. These custom enumeration types support human-readable labels that\ncan be translated and accessed via a property on the enumeration or its\nmembers. See <a class=\"reference internal\" href=\"../../ref/models/fields/#field-choices-enum-types\"><span class=\"std std-ref\">Enumeration types</span></a> for more\ndetails and examples.</p>\n</div>\n<div class=\"section\" id=\"s-minor-features\">\n<span id=\"minor-features\"></span><h3>Minor features<a class=\"headerlink\" href=\"#minor-features\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<div class=\"section\" id=\"s-django-contrib-admin\">\n<span id=\"django-contrib-admin\"></span><h4><a class=\"reference internal\" href=\"../../ref/contrib/admin/#module-django.contrib.admin\" title=\"django.contrib.admin: Django's admin site.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.admin</span></code></a><a class=\"headerlink\" href=\"#django-contrib-admin\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>Added support for the <code class=\"docutils literal notranslate\"><span class=\"pre\">admin_order_field</span></code> attribute on properties in\n<a class=\"reference internal\" href=\"../../ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_display\" title=\"django.contrib.admin.ModelAdmin.list_display\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">ModelAdmin.list_display</span></code></a>.</li>\n<li>The new <a class=\"reference internal\" href=\"../../ref/contrib/admin/#django.contrib.admin.ModelAdmin.get_inlines\" title=\"django.contrib.admin.ModelAdmin.get_inlines\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ModelAdmin.get_inlines()</span></code></a> method allows specifying the\ninlines based on the request or model instance.</li>\n<li>Select2 library is upgraded from version 4.0.3 to 4.0.7.</li>\n<li>jQuery is upgraded from version 3.3.1 to 3.4.1.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-django-contrib-auth\">\n<span id=\"django-contrib-auth\"></span><h4><a class=\"reference internal\" href=\"../../topics/auth/#module-django.contrib.auth\" title=\"django.contrib.auth: Django's authentication framework.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.auth</span></code></a><a class=\"headerlink\" href=\"#django-contrib-auth\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new <code class=\"docutils literal notranslate\"><span class=\"pre\">reset_url_token</span></code> attribute in\n<a class=\"reference internal\" href=\"../../topics/auth/default/#django.contrib.auth.views.PasswordResetConfirmView\" title=\"django.contrib.auth.views.PasswordResetConfirmView\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PasswordResetConfirmView</span></code></a> allows\nspecifying a token parameter displayed as a component of password reset\nURLs.</li>\n<li>Added <a class=\"reference internal\" href=\"../../ref/contrib/auth/#django.contrib.auth.backends.BaseBackend\" title=\"django.contrib.auth.backends.BaseBackend\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">BaseBackend</span></code></a> class to ease\ncustomization of authentication backends.</li>\n<li>Added <a class=\"reference internal\" href=\"../../ref/contrib/auth/#django.contrib.auth.models.User.get_user_permissions\" title=\"django.contrib.auth.models.User.get_user_permissions\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_user_permissions()</span></code></a> method\nto mirror the existing\n<a class=\"reference internal\" href=\"../../ref/contrib/auth/#django.contrib.auth.models.User.get_group_permissions\" title=\"django.contrib.auth.models.User.get_group_permissions\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_group_permissions()</span></code></a> method.</li>\n<li>Added HTML <code class=\"docutils literal notranslate\"><span class=\"pre\">autocomplete</span></code> attribute to widgets of username, email, and\npassword fields in <a class=\"reference internal\" href=\"../../topics/auth/default/#module-django.contrib.auth.forms\" title=\"django.contrib.auth.forms\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.auth.forms</span></code></a> for better interaction\nwith browser password managers.</li>\n<li><a class=\"reference internal\" href=\"../../ref/django-admin/#django-admin-createsuperuser\"><code class=\"xref std std-djadmin docutils literal notranslate\"><span class=\"pre\">createsuperuser</span></code></a> now falls back to environment variables for\npassword and required fields, when a corresponding command line argument\nisn\u2019t provided in non-interactive mode.</li>\n<li><a class=\"reference internal\" href=\"../../topics/auth/customizing/#django.contrib.auth.models.CustomUser.REQUIRED_FIELDS\" title=\"django.contrib.auth.models.CustomUser.REQUIRED_FIELDS\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">REQUIRED_FIELDS</span></code></a> now supports\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.ManyToManyField\" title=\"django.db.models.ManyToManyField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ManyToManyField</span></code></a>s.</li>\n<li>The new <a class=\"reference internal\" href=\"../../ref/contrib/auth/#django.contrib.auth.models.UserManager.with_perm\" title=\"django.contrib.auth.models.UserManager.with_perm\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">UserManager.with_perm()</span></code></a> method returns users that have the\nspecified permission.</li>\n<li>The default iteration count for the PBKDF2 password hasher is increased from\n150,000 to 180,000.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-django-contrib-gis\">\n<span id=\"django-contrib-gis\"></span><h4><a class=\"reference internal\" href=\"../../ref/contrib/gis/#module-django.contrib.gis\" title=\"django.contrib.gis: Geographic Information System (GIS) extensions for Django\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.gis</span></code></a><a class=\"headerlink\" href=\"#django-contrib-gis\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>Allowed MySQL spatial lookup functions to operate on real geometries.\nPrevious support was limited to bounding boxes.</li>\n<li>Added the <a class=\"reference internal\" href=\"../../ref/contrib/gis/functions/#django.contrib.gis.db.models.functions.GeometryDistance\" title=\"django.contrib.gis.db.models.functions.GeometryDistance\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">GeometryDistance</span></code></a>\nfunction, supported on PostGIS.</li>\n<li>Added support for the <code class=\"docutils literal notranslate\"><span class=\"pre\">furlong</span></code> unit in\n<a class=\"reference internal\" href=\"../../ref/contrib/gis/measure/#django.contrib.gis.measure.Distance\" title=\"django.contrib.gis.measure.Distance\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Distance</span></code></a>.</li>\n<li>The <a class=\"reference internal\" href=\"../../ref/contrib/gis/geoip2/#std-setting-GEOIP_PATH\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">GEOIP_PATH</span></code></a> setting now supports <a class=\"reference external\" href=\"https://docs.python.org/3/library/pathlib.html#pathlib.Path\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">pathlib.Path</span></code></a>.</li>\n<li>The <a class=\"reference internal\" href=\"../../ref/contrib/gis/geoip2/#django.contrib.gis.geoip2.GeoIP2\" title=\"django.contrib.gis.geoip2.GeoIP2\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">GeoIP2</span></code></a> class now accepts\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/pathlib.html#pathlib.Path\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">pathlib.Path</span></code></a> <code class=\"docutils literal notranslate\"><span class=\"pre\">path</span></code>.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-django-contrib-postgres\">\n<span id=\"django-contrib-postgres\"></span><h4><a class=\"reference internal\" href=\"../../ref/contrib/postgres/#module-django.contrib.postgres\" title=\"django.contrib.postgres: PostgreSQL-specific fields and features\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.postgres</span></code></a><a class=\"headerlink\" href=\"#django-contrib-postgres\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new <a class=\"reference internal\" href=\"../../ref/contrib/postgres/fields/#django.contrib.postgres.fields.RangeOperators\" title=\"django.contrib.postgres.fields.RangeOperators\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">RangeOperators</span></code></a> helps to\navoid typos in SQL operators that can be used together with\n<a class=\"reference internal\" href=\"../../ref/contrib/postgres/fields/#django.contrib.postgres.fields.RangeField\" title=\"django.contrib.postgres.fields.RangeField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">RangeField</span></code></a>.</li>\n<li>The new <a class=\"reference internal\" href=\"../../ref/contrib/postgres/fields/#django.contrib.postgres.fields.RangeBoundary\" title=\"django.contrib.postgres.fields.RangeBoundary\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">RangeBoundary</span></code></a> expression\nrepresents the range boundaries.</li>\n<li>The new <a class=\"reference internal\" href=\"../../ref/contrib/postgres/operations/#django.contrib.postgres.operations.AddIndexConcurrently\" title=\"django.contrib.postgres.operations.AddIndexConcurrently\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">AddIndexConcurrently</span></code></a>\nand <a class=\"reference internal\" href=\"../../ref/contrib/postgres/operations/#django.contrib.postgres.operations.RemoveIndexConcurrently\" title=\"django.contrib.postgres.operations.RemoveIndexConcurrently\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">RemoveIndexConcurrently</span></code></a>\nclasses allow creating and dropping indexes <code class=\"docutils literal notranslate\"><span class=\"pre\">CONCURRENTLY</span></code> on PostgreSQL.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-django-contrib-sessions\">\n<span id=\"django-contrib-sessions\"></span><h4><a class=\"reference internal\" href=\"../../topics/http/sessions/#module-django.contrib.sessions\" title=\"django.contrib.sessions: Provides session management for Django projects.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.sessions</span></code></a><a class=\"headerlink\" href=\"#django-contrib-sessions\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new\n<a class=\"reference internal\" href=\"../../topics/http/sessions/#django.contrib.sessions.backends.base.SessionBase.get_session_cookie_age\" title=\"django.contrib.sessions.backends.base.SessionBase.get_session_cookie_age\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_session_cookie_age()</span></code></a>\nmethod allows dynamically specifying the session cookie age.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-django-contrib-syndication\">\n<span id=\"django-contrib-syndication\"></span><h4><a class=\"reference internal\" href=\"../../ref/contrib/syndication/#module-django.contrib.syndication\" title=\"django.contrib.syndication: A framework for generating syndication feeds, in RSS and Atom, quite easily.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.syndication</span></code></a><a class=\"headerlink\" href=\"#django-contrib-syndication\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>Added the <code class=\"docutils literal notranslate\"><span class=\"pre\">language</span></code> class attribute to the\n<a class=\"reference internal\" href=\"../../ref/contrib/syndication/#django.contrib.syndication.views.Feed\" title=\"django.contrib.syndication.views.Feed\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">django.contrib.syndication.views.Feed</span></code></a> to customize a feed language.\nThe default value is <a class=\"reference internal\" href=\"../../ref/utils/#django.utils.translation.get_language\" title=\"django.utils.translation.get_language\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">get_language()</span></code></a> instead\nof <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-LANGUAGE_CODE\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">LANGUAGE_CODE</span></code></a>.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-cache\">\n<span id=\"cache\"></span><h4>Cache<a class=\"headerlink\" href=\"#cache\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li><a class=\"reference internal\" href=\"../../ref/utils/#django.utils.cache.add_never_cache_headers\" title=\"django.utils.cache.add_never_cache_headers\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">add_never_cache_headers()</span></code></a> and\n<a class=\"reference internal\" href=\"../../topics/http/decorators/#django.views.decorators.cache.never_cache\" title=\"django.views.decorators.cache.never_cache\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">never_cache()</span></code></a> now add the <code class=\"docutils literal notranslate\"><span class=\"pre\">private</span></code>\ndirective to <code class=\"docutils literal notranslate\"><span class=\"pre\">Cache-Control</span></code> headers.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-file-storage\">\n<span id=\"file-storage\"></span><h4>File Storage<a class=\"headerlink\" href=\"#file-storage\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new <a class=\"reference internal\" href=\"../../ref/files/storage/#django.core.files.storage.Storage.get_alternative_name\" title=\"django.core.files.storage.Storage.get_alternative_name\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">Storage.get_alternative_name()</span></code></a> method allows customizing the\nalgorithm for generating filenames if a file with the uploaded name already\nexists.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-forms\">\n<span id=\"forms\"></span><h4>Forms<a class=\"headerlink\" href=\"#forms\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>Formsets may control the widget used when ordering forms via\n<a class=\"reference internal\" href=\"../../topics/forms/formsets/#django.forms.formsets.BaseFormSet.can_order\" title=\"django.forms.formsets.BaseFormSet.can_order\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">can_order</span></code></a> by setting the\n<a class=\"reference internal\" href=\"../../topics/forms/formsets/#django.forms.formsets.BaseFormSet.ordering_widget\" title=\"django.forms.formsets.BaseFormSet.ordering_widget\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">ordering_widget</span></code></a> attribute or\noverriding <a class=\"reference internal\" href=\"../../topics/forms/formsets/#django.forms.formsets.BaseFormSet.get_ordering_widget\" title=\"django.forms.formsets.BaseFormSet.get_ordering_widget\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">get_ordering_widget()</span></code></a>.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-internationalization\">\n<span id=\"internationalization\"></span><h4>Internationalization<a class=\"headerlink\" href=\"#internationalization\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>Added the <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-LANGUAGE_COOKIE_HTTPONLY\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">LANGUAGE_COOKIE_HTTPONLY</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/settings/#std-setting-LANGUAGE_COOKIE_SAMESITE\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">LANGUAGE_COOKIE_SAMESITE</span></code></a>, and <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-LANGUAGE_COOKIE_SECURE\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">LANGUAGE_COOKIE_SECURE</span></code></a>\nsettings to set the <code class=\"docutils literal notranslate\"><span class=\"pre\">HttpOnly</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">SameSite</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">Secure</span></code> flags on\nlanguage cookies. The default values of these settings preserve the previous\nbehavior.</li>\n<li>Added support and translations for the Uzbek language.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-logging\">\n<span id=\"logging\"></span><h4>Logging<a class=\"headerlink\" href=\"#logging\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new <code class=\"docutils literal notranslate\"><span class=\"pre\">reporter_class</span></code> parameter of\n<a class=\"reference internal\" href=\"../../ref/logging/#django.utils.log.AdminEmailHandler\" title=\"django.utils.log.AdminEmailHandler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">AdminEmailHandler</span></code></a> allows providing an\n<code class=\"docutils literal notranslate\"><span class=\"pre\">django.views.debug.ExceptionReporter</span></code> subclass to customize the traceback\ntext sent to site <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-ADMINS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">ADMINS</span></code></a> when <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-DEBUG\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">DEBUG</span></code></a> is <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-management-commands\">\n<span id=\"management-commands\"></span><h4>Management Commands<a class=\"headerlink\" href=\"#management-commands\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new <a class=\"reference internal\" href=\"../../ref/django-admin/#cmdoption-compilemessages-ignore\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">compilemessages</span> <span class=\"pre\">--ignore</span></code></a> option allows ignoring specific\ndirectories when searching for <code class=\"docutils literal notranslate\"><span class=\"pre\">.po</span></code> files to compile.</li>\n<li><a class=\"reference internal\" href=\"../../ref/django-admin/#cmdoption-showmigrations-list\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">showmigrations</span> <span class=\"pre\">--list</span></code></a> now shows the applied datetimes when\n<code class=\"docutils literal notranslate\"><span class=\"pre\">--verbosity</span></code> is 2 and above.</li>\n<li>On PostgreSQL, <a class=\"reference internal\" href=\"../../ref/django-admin/#django-admin-dbshell\"><code class=\"xref std std-djadmin docutils literal notranslate\"><span class=\"pre\">dbshell</span></code></a> now supports client-side TLS certificates.</li>\n<li><a class=\"reference internal\" href=\"../../ref/django-admin/#django-admin-inspectdb\"><code class=\"xref std std-djadmin docutils literal notranslate\"><span class=\"pre\">inspectdb</span></code></a> now introspects <a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.OneToOneField\" title=\"django.db.models.OneToOneField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">OneToOneField</span></code></a>\nwhen a foreign key has a unique or primary key constraint.</li>\n<li>The new <a class=\"reference internal\" href=\"../../ref/django-admin/#cmdoption-skip-checks\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">--skip-checks</span></code></a> option skips running system checks prior to\nrunning the command.</li>\n<li>The <a class=\"reference internal\" href=\"../../ref/django-admin/#cmdoption-startapp-template\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">startapp</span> <span class=\"pre\">--template</span></code></a> and <a class=\"reference internal\" href=\"../../ref/django-admin/#cmdoption-startproject-template\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">startproject</span> <span class=\"pre\">--template</span></code></a>\noptions now support templates stored in XZ archives (<code class=\"docutils literal notranslate\"><span class=\"pre\">.tar.xz</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">.txz</span></code>)\nand LZMA archives (<code class=\"docutils literal notranslate\"><span class=\"pre\">.tar.lzma</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">.tlz</span></code>).</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-models\">\n<span id=\"models\"></span><h4>Models<a class=\"headerlink\" href=\"#models\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul>\n<li><p class=\"first\">Added hash database functions <a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.MD5\" title=\"django.db.models.functions.MD5\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">MD5</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.SHA1\" title=\"django.db.models.functions.SHA1\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SHA1</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.SHA224\" title=\"django.db.models.functions.SHA224\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SHA224</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.SHA256\" title=\"django.db.models.functions.SHA256\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SHA256</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.SHA384\" title=\"django.db.models.functions.SHA384\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SHA384</span></code></a>, and\n<a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.SHA512\" title=\"django.db.models.functions.SHA512\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SHA512</span></code></a>.</p>\n</li>\n<li><p class=\"first\">Added the <a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.Sign\" title=\"django.db.models.functions.Sign\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Sign</span></code></a> database function.</p>\n</li>\n<li><p class=\"first\">The new <code class=\"docutils literal notranslate\"><span class=\"pre\">is_dst</span></code>  parameter of the\n<a class=\"reference internal\" href=\"../../ref/models/database-functions/#django.db.models.functions.Trunc\" title=\"django.db.models.functions.Trunc\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Trunc</span></code></a> database functions determines the\ntreatment of nonexistent and ambiguous datetimes.</p>\n</li>\n<li><p class=\"first\"><code class=\"docutils literal notranslate\"><span class=\"pre\">connection.queries</span></code> now shows <code class=\"docutils literal notranslate\"><span class=\"pre\">COPY</span> <span class=\"pre\">\u2026</span> <span class=\"pre\">TO</span></code> statements on PostgreSQL.</p>\n</li>\n<li><p class=\"first\"><a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.FilePathField\" title=\"django.db.models.FilePathField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">FilePathField</span></code></a> now accepts a callable for <code class=\"docutils literal notranslate\"><span class=\"pre\">path</span></code>.</p>\n</li>\n<li><p class=\"first\">Allowed symmetrical intermediate table for self-referential\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.ManyToManyField\" title=\"django.db.models.ManyToManyField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ManyToManyField</span></code></a>.</p>\n</li>\n<li><p class=\"first\">The <code class=\"docutils literal notranslate\"><span class=\"pre\">name</span></code> attributes of <a class=\"reference internal\" href=\"../../ref/models/constraints/#django.db.models.CheckConstraint\" title=\"django.db.models.CheckConstraint\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">CheckConstraint</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/models/constraints/#django.db.models.UniqueConstraint\" title=\"django.db.models.UniqueConstraint\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">UniqueConstraint</span></code></a>, and\n<a class=\"reference internal\" href=\"../../ref/models/indexes/#django.db.models.Index\" title=\"django.db.models.Index\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Index</span></code></a> now support app label and class\ninterpolation using the <code class=\"docutils literal notranslate\"><span class=\"pre\">'%(app_label)s'</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">'%(class)s'</span></code> placeholders.</p>\n</li>\n<li><p class=\"first\">The new <a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.Field.descriptor_class\" title=\"django.db.models.Field.descriptor_class\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Field.descriptor_class</span></code></a> attribute allows model fields to\ncustomize the get and set behavior by overriding their\n<a class=\"reference external\" href=\"https://docs.python.org/3/reference/datamodel.html#descriptors\" title=\"(in Python v3.11)\"><span class=\"xref std std-ref\">descriptors</span></a>.</p>\n</li>\n<li><p class=\"first\"><a class=\"reference internal\" href=\"../../ref/models/querysets/#django.db.models.Avg\" title=\"django.db.models.Avg\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Avg</span></code></a> and <a class=\"reference internal\" href=\"../../ref/models/querysets/#django.db.models.Sum\" title=\"django.db.models.Sum\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Sum</span></code></a> now support\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">distinct</span></code> argument.</p>\n</li>\n<li><p class=\"first\">Added <a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.SmallAutoField\" title=\"django.db.models.SmallAutoField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SmallAutoField</span></code></a> which acts much like an\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.AutoField\" title=\"django.db.models.AutoField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">AutoField</span></code></a> except that it only allows values under\na certain (database-dependent) limit. Values from <code class=\"docutils literal notranslate\"><span class=\"pre\">1</span></code> to <code class=\"docutils literal notranslate\"><span class=\"pre\">32767</span></code> are safe\nin all databases supported by Django.</p>\n</li>\n<li><p class=\"first\"><a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.AutoField\" title=\"django.db.models.AutoField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">AutoField</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.BigAutoField\" title=\"django.db.models.BigAutoField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">BigAutoField</span></code></a>, and\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.SmallAutoField\" title=\"django.db.models.SmallAutoField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SmallAutoField</span></code></a> now inherit from\n<code class=\"docutils literal notranslate\"><span class=\"pre\">IntegerField</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">BigIntegerField</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">SmallIntegerField</span></code> respectively.\nSystem checks and validators are now also properly inherited.</p>\n</li>\n<li><p class=\"first\"><a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.FileField.upload_to\" title=\"django.db.models.FileField.upload_to\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">FileField.upload_to</span></code></a> now supports <a class=\"reference external\" href=\"https://docs.python.org/3/library/pathlib.html#pathlib.Path\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">pathlib.Path</span></code></a>.</p>\n</li>\n<li><p class=\"first\"><a class=\"reference internal\" href=\"../../ref/models/constraints/#django.db.models.CheckConstraint\" title=\"django.db.models.CheckConstraint\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">CheckConstraint</span></code></a> is now supported on MySQL 8.0.16+.</p>\n</li>\n<li><p class=\"first\">The new <code class=\"docutils literal notranslate\"><span class=\"pre\">allows_group_by_selected_pks_on_model()</span></code> method of\n<code class=\"docutils literal notranslate\"><span class=\"pre\">django.db.backends.base.BaseDatabaseFeatures</span></code> allows optimization of\n<code class=\"docutils literal notranslate\"><span class=\"pre\">GROUP</span> <span class=\"pre\">BY</span></code> clauses to require only the selected models\u2019 primary keys. By\ndefault, it\u2019s supported only for managed models on PostgreSQL.</p>\n<p>To enable the <code class=\"docutils literal notranslate\"><span class=\"pre\">GROUP</span> <span class=\"pre\">BY</span></code> primary key-only optimization for unmanaged\nmodels, you have to subclass the PostgreSQL database engine, overriding the\nfeatures class <code class=\"docutils literal notranslate\"><span class=\"pre\">allows_group_by_selected_pks_on_model()</span></code> method as you\nrequire. See <a class=\"reference internal\" href=\"../../ref/databases/#subclassing-database-backends\"><span class=\"std std-ref\">Subclassing the built-in database backends</span></a> for an example.</p>\n</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-requests-and-responses\">\n<span id=\"requests-and-responses\"></span><h4>Requests and Responses<a class=\"headerlink\" href=\"#requests-and-responses\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>Allowed <a class=\"reference internal\" href=\"../../ref/request-response/#django.http.HttpResponse\" title=\"django.http.HttpResponse\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">HttpResponse</span></code></a> to be initialized with\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/stdtypes.html#memoryview\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">memoryview</span></code></a> content.</li>\n<li>For use in, for example, Django templates, <a class=\"reference internal\" href=\"../../ref/request-response/#django.http.HttpRequest.headers\" title=\"django.http.HttpRequest.headers\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">HttpRequest.headers</span></code></a> now\nallows lookups using underscores (e.g. <code class=\"docutils literal notranslate\"><span class=\"pre\">user_agent</span></code>) in place of hyphens.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-security\">\n<span id=\"s-whats-new-security-3-0\"></span><span id=\"security\"></span><span id=\"whats-new-security-3-0\"></span><h4>Security<a class=\"headerlink\" href=\"#security\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li><a class=\"reference internal\" href=\"../../ref/settings/#std-setting-X_FRAME_OPTIONS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">X_FRAME_OPTIONS</span></code></a> now defaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">'DENY'</span></code>. In older versions, the\n<a class=\"reference internal\" href=\"../../ref/settings/#std-setting-X_FRAME_OPTIONS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">X_FRAME_OPTIONS</span></code></a> setting defaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">'SAMEORIGIN'</span></code>. If your site\nuses frames of itself, you will need to explicitly set <code class=\"docutils literal notranslate\"><span class=\"pre\">X_FRAME_OPTIONS</span> <span class=\"pre\">=</span>\n<span class=\"pre\">'SAMEORIGIN'</span></code> for them to continue working.</li>\n<li><a class=\"reference internal\" href=\"../../ref/settings/#std-setting-SECURE_CONTENT_TYPE_NOSNIFF\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">SECURE_CONTENT_TYPE_NOSNIFF</span></code></a> now defaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code>. With this\nenabled, <a class=\"reference internal\" href=\"../../ref/middleware/#django.middleware.security.SecurityMiddleware\" title=\"django.middleware.security.SecurityMiddleware\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SecurityMiddleware</span></code></a> sets the\n<a class=\"reference internal\" href=\"../../ref/middleware/#x-content-type-options\"><span class=\"std std-ref\">X-Content-Type-Options: nosniff</span></a> header on all responses that do not already\nhave it.</li>\n<li><a class=\"reference internal\" href=\"../../ref/middleware/#django.middleware.security.SecurityMiddleware\" title=\"django.middleware.security.SecurityMiddleware\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SecurityMiddleware</span></code></a> can now send the\n<a class=\"reference internal\" href=\"../../ref/middleware/#referrer-policy\"><span class=\"std std-ref\">Referrer-Policy</span></a> header.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-tests\">\n<span id=\"tests\"></span><h4>Tests<a class=\"headerlink\" href=\"#tests\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<ul class=\"simple\">\n<li>The new test <a class=\"reference internal\" href=\"../../topics/testing/tools/#django.test.Client\" title=\"django.test.Client\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Client</span></code></a> argument\n<code class=\"docutils literal notranslate\"><span class=\"pre\">raise_request_exception</span></code> allows controlling whether or not exceptions\nraised during the request should also be raised in the test. The value\ndefaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> for backwards compatibility. If it is <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code> and an\nexception occurs, the test client will return a 500 response with the\nattribute <a class=\"reference internal\" href=\"../../topics/testing/tools/#django.test.Response.exc_info\" title=\"django.test.Response.exc_info\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">exc_info</span></code></a>, a tuple providing\ninformation of the exception that occurred.</li>\n<li>Tests and test cases to run can be selected by test name pattern using the\nnew <a class=\"reference internal\" href=\"../../ref/django-admin/#cmdoption-test-k\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">test</span> <span class=\"pre\">-k</span></code></a> option.</li>\n<li>HTML comparison, as used by\n<a class=\"reference internal\" href=\"../../topics/testing/tools/#django.test.SimpleTestCase.assertHTMLEqual\" title=\"django.test.SimpleTestCase.assertHTMLEqual\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">assertHTMLEqual()</span></code></a>, now treats text, character\nreferences, and entity references that refer to the same character as\nequivalent.</li>\n<li>Django test runner now supports headless mode for selenium tests on supported\nbrowsers. Add the <code class=\"docutils literal notranslate\"><span class=\"pre\">--headless</span></code> option to enable this mode.</li>\n<li>Django test runner now supports <code class=\"docutils literal notranslate\"><span class=\"pre\">--start-at</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">--start-after</span></code> options\nto run tests starting from a specific top-level module.</li>\n<li>Django test runner now supports a <code class=\"docutils literal notranslate\"><span class=\"pre\">--pdb</span></code> option to spawn a debugger at\neach error or failure.</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"s-backwards-incompatible-changes-in-3-0\">\n<span id=\"s-backwards-incompatible-3-0\"></span><span id=\"backwards-incompatible-changes-in-3-0\"></span><span id=\"backwards-incompatible-3-0\"></span><h2>Backwards incompatible changes in 3.0<a class=\"headerlink\" href=\"#backwards-incompatible-changes-in-3-0\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"s-model-save-when-providing-a-default-for-the-primary-key\">\n<span id=\"model-save-when-providing-a-default-for-the-primary-key\"></span><h3><code class=\"docutils literal notranslate\"><span class=\"pre\">Model.save()</span></code> when providing a default for the primary key<a class=\"headerlink\" href=\"#model-save-when-providing-a-default-for-the-primary-key\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p><a class=\"reference internal\" href=\"../../ref/models/instances/#django.db.models.Model.save\" title=\"django.db.models.Model.save\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">Model.save()</span></code></a> no longer attempts to find a row when saving a new\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Model</span></code> instance and a default value for the primary key is provided, and\nalways performs a single <code class=\"docutils literal notranslate\"><span class=\"pre\">INSERT</span></code> query. In older Django versions,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Model.save()</span></code> performed either an <code class=\"docutils literal notranslate\"><span class=\"pre\">INSERT</span></code> or an <code class=\"docutils literal notranslate\"><span class=\"pre\">UPDATE</span></code> based on\nwhether or not the row exists.</p>\n<p>This makes calling <code class=\"docutils literal notranslate\"><span class=\"pre\">Model.save()</span></code> while providing a default primary key value\nequivalent to passing <a class=\"reference internal\" href=\"../../ref/models/instances/#ref-models-force-insert\"><span class=\"std std-ref\">force_insert=True</span></a> to\nmodel\u2019s <code class=\"docutils literal notranslate\"><span class=\"pre\">save()</span></code>. Attempts to use a new <code class=\"docutils literal notranslate\"><span class=\"pre\">Model</span></code> instance to update an\nexisting row will result in an <code class=\"docutils literal notranslate\"><span class=\"pre\">IntegrityError</span></code>.</p>\n<p>In order to update an existing model for a specific primary key value, use the\n<a class=\"reference internal\" href=\"../../ref/models/querysets/#django.db.models.query.QuerySet.update_or_create\" title=\"django.db.models.query.QuerySet.update_or_create\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">update_or_create()</span></code></a> method or\n<code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet.filter(pk=\u2026).update(\u2026)</span></code> instead. For example:</p>\n<div class=\"highlight-pycon notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">MyModel</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">update_or_create</span><span class=\"p\">(</span><span class=\"n\">pk</span><span class=\"o\">=</span><span class=\"n\">existing_pk</span><span class=\"p\">,</span> <span class=\"n\">defaults</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">&quot;name&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;new name&quot;</span><span class=\"p\">})</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">MyModel</span><span class=\"o\">.</span><span class=\"n\">objects</span><span class=\"o\">.</span><span class=\"n\">filter</span><span class=\"p\">(</span><span class=\"n\">pk</span><span class=\"o\">=</span><span class=\"n\">existing_pk</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;new name&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"s-database-backend-api\">\n<span id=\"database-backend-api\"></span><h3>Database backend API<a class=\"headerlink\" href=\"#database-backend-api\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>This section describes changes that may be needed in third-party database\nbackends.</p>\n<ul class=\"simple\">\n<li>The second argument of <code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseIntrospection.get_geometry_type()</span></code> is now\nthe row description instead of the column name.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseIntrospection.get_field_type()</span></code> may no longer return tuples.</li>\n<li>If the database can create foreign keys in the same SQL statement that adds a\nfield, add <code class=\"docutils literal notranslate\"><span class=\"pre\">SchemaEditor.sql_create_column_inline_fk</span></code> with the appropriate\nSQL; otherwise, set <code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseFeatures.can_create_inline_fk</span> <span class=\"pre\">=</span> <span class=\"pre\">False</span></code>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseFeatures.can_return_id_from_insert</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">can_return_ids_from_bulk_insert</span></code> are renamed to\n<code class=\"docutils literal notranslate\"><span class=\"pre\">can_return_columns_from_insert</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">can_return_rows_from_bulk_insert</span></code>.</li>\n<li>Database functions now handle <a class=\"reference external\" href=\"https://docs.python.org/3/library/datetime.html#datetime.timezone\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">datetime.timezone</span></code></a> formats when created\nusing <a class=\"reference external\" href=\"https://docs.python.org/3/library/datetime.html#datetime.timedelta\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">datetime.timedelta</span></code></a> instances (e.g.\n<code class=\"docutils literal notranslate\"><span class=\"pre\">timezone(timedelta(hours=5))</span></code>, which would output <code class=\"docutils literal notranslate\"><span class=\"pre\">'UTC+05:00'</span></code>).\nThird-party backends should handle this format when preparing\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.DateTimeField\" title=\"django.db.models.DateTimeField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">DateTimeField</span></code></a> in <code class=\"docutils literal notranslate\"><span class=\"pre\">datetime_cast_date_sql()</span></code>,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">datetime_extract_sql()</span></code>, etc.</li>\n<li>Entries for <code class=\"docutils literal notranslate\"><span class=\"pre\">AutoField</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">BigAutoField</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">SmallAutoField</span></code> are added\nto  <code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseOperations.integer_field_ranges</span></code> to support the integer range\nvalidators on these field types. Third-party backends may need to customize\nthe default entries.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseOperations.fetch_returned_insert_id()</span></code> is replaced by\n<code class=\"docutils literal notranslate\"><span class=\"pre\">fetch_returned_insert_columns()</span></code> which returns a list of values returned\nby the <code class=\"docutils literal notranslate\"><span class=\"pre\">INSERT</span> <span class=\"pre\">\u2026</span> <span class=\"pre\">RETURNING</span></code> statement, instead of a single value.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">DatabaseOperations.return_insert_id()</span></code> is replaced by\n<code class=\"docutils literal notranslate\"><span class=\"pre\">return_insert_columns()</span></code> that accepts a <code class=\"docutils literal notranslate\"><span class=\"pre\">fields</span></code>\nargument, which is an iterable of fields to be returned after insert. Usually\nthis is only the auto-generated primary key.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-id1\">\n<span id=\"id1\"></span><h3><a class=\"reference internal\" href=\"../../ref/contrib/admin/#module-django.contrib.admin\" title=\"django.contrib.admin: Django's admin site.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.admin</span></code></a><a class=\"headerlink\" href=\"#id1\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<ul class=\"simple\">\n<li>Admin\u2019s model history change messages now prefers more readable field labels\ninstead of field names.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-id2\">\n<span id=\"id2\"></span><h3><a class=\"reference internal\" href=\"../../ref/contrib/gis/#module-django.contrib.gis\" title=\"django.contrib.gis: Geographic Information System (GIS) extensions for Django\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.gis</span></code></a><a class=\"headerlink\" href=\"#id2\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<ul class=\"simple\">\n<li>Support for PostGIS 2.1 is removed.</li>\n<li>Support for SpatiaLite 4.1 and 4.2 is removed.</li>\n<li>Support for GDAL 1.11 and GEOS 3.4 is removed.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-dropped-support-for-postgresql-9-4\">\n<span id=\"dropped-support-for-postgresql-9-4\"></span><h3>Dropped support for PostgreSQL 9.4<a class=\"headerlink\" href=\"#dropped-support-for-postgresql-9-4\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Upstream support for PostgreSQL 9.4 ends in December 2019. Django 3.0 supports\nPostgreSQL 9.5 and higher.</p>\n</div>\n<div class=\"section\" id=\"s-dropped-support-for-oracle-12-1\">\n<span id=\"dropped-support-for-oracle-12-1\"></span><h3>Dropped support for Oracle 12.1<a class=\"headerlink\" href=\"#dropped-support-for-oracle-12-1\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Upstream support for Oracle 12.1 ends in July 2021. Django 2.2 will be\nsupported until April 2022. Django 3.0 officially supports Oracle 12.2 and 18c.</p>\n</div>\n<div class=\"section\" id=\"s-removed-private-python-2-compatibility-apis\">\n<span id=\"removed-private-python-2-compatibility-apis\"></span><h3>Removed private Python 2 compatibility APIs<a class=\"headerlink\" href=\"#removed-private-python-2-compatibility-apis\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>While Python 2 support was removed in Django 2.0, some private APIs weren\u2019t\nremoved from Django so that third party apps could continue using them until\nthe Python 2 end-of-life.</p>\n<p>Since we expect apps to drop Python 2 compatibility when adding support for\nDjango 3.0, we\u2019re removing these APIs at this time.</p>\n<ul class=\"simple\">\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.test.utils.str_prefix()</span></code> - Strings don\u2019t have \u2018u\u2019 prefixes in\nPython 3.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.test.utils.patch_logger()</span></code> - Use\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertLogs\" title=\"(in Python v3.11)\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">unittest.TestCase.assertLogs()</span></code></a> instead.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.lru_cache.lru_cache()</span></code> - Alias of\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/functools.html#functools.lru_cache\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">functools.lru_cache()</span></code></a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.decorators.available_attrs()</span></code> - This function returns\n<code class=\"docutils literal notranslate\"><span class=\"pre\">functools.WRAPPER_ASSIGNMENTS</span></code>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.decorators.ContextDecorator</span></code> - Alias of\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/contextlib.html#contextlib.ContextDecorator\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">contextlib.ContextDecorator</span></code></a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils._os.abspathu()</span></code> - Alias of <a class=\"reference external\" href=\"https://docs.python.org/3/library/os.path.html#os.path.abspath\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">os.path.abspath()</span></code></a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils._os.upath()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">npath()</span></code> - These functions do nothing on\nPython 3.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.six</span></code> - Remove usage of this vendored library or switch to\n<a class=\"reference external\" href=\"https://pypi.org/project/six/\">six</a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.encoding.python_2_unicode_compatible()</span></code> - Alias of\n<code class=\"docutils literal notranslate\"><span class=\"pre\">six.python_2_unicode_compatible()</span></code>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.functional.curry()</span></code> - Use <a class=\"reference external\" href=\"https://docs.python.org/3/library/functools.html#functools.partial\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">functools.partial()</span></code></a> or\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/functools.html#functools.partialmethod\" title=\"(in Python v3.11)\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">functools.partialmethod</span></code></a>. See\n<a class=\"reference external\" href=\"https://github.com/django/django/commit/5b1c389603a353625ae1603ba345147356336afb\">5b1c389603a353625ae1603ba345147356336afb</a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.safestring.SafeBytes</span></code> - Unused since Django 2.0.</li>\n</ul>\n</div>\n<div class=\"section\" id=\"s-new-default-value-for-the-file-upload-permissions-setting\">\n<span id=\"new-default-value-for-the-file-upload-permissions-setting\"></span><h3>New default value for the <code class=\"docutils literal notranslate\"><span class=\"pre\">FILE_UPLOAD_PERMISSIONS</span></code> setting<a class=\"headerlink\" href=\"#new-default-value-for-the-file-upload-permissions-setting\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>In older versions, the <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-FILE_UPLOAD_PERMISSIONS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">FILE_UPLOAD_PERMISSIONS</span></code></a> setting defaults to\n<code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>. With the default <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-FILE_UPLOAD_HANDLERS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">FILE_UPLOAD_HANDLERS</span></code></a>, this results in\nuploaded files having different permissions depending on their size and which\nupload handler is used.</p>\n<p><code class=\"docutils literal notranslate\"><span class=\"pre\">FILE_UPLOAD_PERMISSIONS</span></code> now defaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">0o644</span></code> to avoid this\ninconsistency.</p>\n</div>\n<div class=\"section\" id=\"s-new-default-values-for-security-settings\">\n<span id=\"new-default-values-for-security-settings\"></span><h3>New default values for security settings<a class=\"headerlink\" href=\"#new-default-values-for-security-settings\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>To make Django projects more secure by default, some security settings now have\nmore secure default values:</p>\n<ul class=\"simple\">\n<li><a class=\"reference internal\" href=\"../../ref/settings/#std-setting-X_FRAME_OPTIONS\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">X_FRAME_OPTIONS</span></code></a> now defaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">'DENY'</span></code>.</li>\n<li><a class=\"reference internal\" href=\"../../ref/settings/#std-setting-SECURE_CONTENT_TYPE_NOSNIFF\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">SECURE_CONTENT_TYPE_NOSNIFF</span></code></a> now defaults to <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code>.</li>\n</ul>\n<p>See the <em>What\u2019s New</em> <a class=\"reference internal\" href=\"#whats-new-security-3-0\"><span class=\"std std-ref\">Security section</span></a> above for\nmore details on these changes.</p>\n</div>\n<div class=\"section\" id=\"s-miscellaneous\">\n<span id=\"miscellaneous\"></span><h3>Miscellaneous<a class=\"headerlink\" href=\"#miscellaneous\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<ul class=\"simple\">\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">ContentType.__str__()</span></code> now includes the model\u2019s <code class=\"docutils literal notranslate\"><span class=\"pre\">app_label</span></code> to\ndisambiguate models with the same name in different apps.</li>\n<li>Because accessing the language in the session rather than in the cookie is\ndeprecated, <code class=\"docutils literal notranslate\"><span class=\"pre\">LocaleMiddleware</span></code> no longer looks for the user\u2019s language in\nthe session and <a class=\"reference internal\" href=\"../../topics/auth/default/#django.contrib.auth.logout\" title=\"django.contrib.auth.logout\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">django.contrib.auth.logout()</span></code></a> no longer preserves the\nsession\u2019s language after logout.</li>\n<li><a class=\"reference internal\" href=\"../../ref/utils/#django.utils.html.escape\" title=\"django.utils.html.escape\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">django.utils.html.escape()</span></code></a> now uses <a class=\"reference external\" href=\"https://docs.python.org/3/library/html.html#html.escape\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">html.escape()</span></code></a> to escape HTML.\nThis converts <code class=\"docutils literal notranslate\"><span class=\"pre\">'</span></code> to <code class=\"docutils literal notranslate\"><span class=\"pre\">&amp;#x27;</span></code> instead of the previous equivalent decimal\ncode <code class=\"docutils literal notranslate\"><span class=\"pre\">&amp;#39;</span></code>.</li>\n<li>The <code class=\"docutils literal notranslate\"><span class=\"pre\">django-admin</span> <span class=\"pre\">test</span> <span class=\"pre\">-k</span></code> option now works as the <a class=\"reference external\" href=\"https://docs.python.org/3/library/unittest.html#cmdoption-unittest-k\" title=\"(in Python v3.11)\"><code class=\"xref std std-option docutils literal notranslate\"><span class=\"pre\">unittest</span>\n<span class=\"pre\">-k</span></code></a> option rather than as a shortcut for <code class=\"docutils literal notranslate\"><span class=\"pre\">--keepdb</span></code>.</li>\n<li>Support for <code class=\"docutils literal notranslate\"><span class=\"pre\">pywatchman</span></code> &lt; 1.2.0 is removed.</li>\n<li><a class=\"reference internal\" href=\"../../ref/utils/#django.utils.http.urlencode\" title=\"django.utils.http.urlencode\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">urlencode()</span></code></a> now encodes iterable values as they are\nwhen <code class=\"docutils literal notranslate\"><span class=\"pre\">doseq=False</span></code>, rather than iterating them, bringing it into line with\nthe standard library <a class=\"reference external\" href=\"https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">urllib.parse.urlencode()</span></code></a> function.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">intword</span></code> template filter now translates <code class=\"docutils literal notranslate\"><span class=\"pre\">1.0</span></code> as a singular phrase and\nall other numeric values as plural. This may be incorrect for some languages.</li>\n<li>Assigning a value to a model\u2019s <a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.ForeignKey\" title=\"django.db.models.ForeignKey\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ForeignKey</span></code></a> or\n<a class=\"reference internal\" href=\"../../ref/models/fields/#django.db.models.OneToOneField\" title=\"django.db.models.OneToOneField\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">OneToOneField</span></code></a> <code class=\"docutils literal notranslate\"><span class=\"pre\">'_id'</span></code> attribute now unsets the\ncorresponding field. Accessing the field afterward will result in a query.</li>\n<li><a class=\"reference internal\" href=\"../../ref/utils/#django.utils.cache.patch_vary_headers\" title=\"django.utils.cache.patch_vary_headers\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">patch_vary_headers()</span></code></a> now handles an asterisk\n<code class=\"docutils literal notranslate\"><span class=\"pre\">'*'</span></code> according to <span class=\"target\" id=\"index-0\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc7231.html#section-7.1.4\"><strong>RFC 7231#section-7.1.4</strong></a>, i.e. if a list of header\nfield names contains an asterisk, then the <code class=\"docutils literal notranslate\"><span class=\"pre\">Vary</span></code> header will consist of a\nsingle asterisk <code class=\"docutils literal notranslate\"><span class=\"pre\">'*'</span></code>.</li>\n<li>On MySQL 8.0.16+, <code class=\"docutils literal notranslate\"><span class=\"pre\">PositiveIntegerField</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">PositiveSmallIntegerField</span></code>\nnow include a check constraint to prevent negative values in the database.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">alias=None</span></code> is added to the signature of\n<a class=\"reference internal\" href=\"../../ref/models/expressions/#django.db.models.Expression.get_group_by_cols\" title=\"django.db.models.Expression.get_group_by_cols\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">Expression.get_group_by_cols()</span></code></a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">RegexPattern</span></code>, used by <a class=\"reference internal\" href=\"../../ref/urls/#django.urls.re_path\" title=\"django.urls.re_path\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">re_path()</span></code></a>, no longer returns\nkeyword arguments with <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> values to be passed to the view for the\noptional named groups that are missing.</li>\n</ul>\n</div>\n</div>\n<div class=\"section\" id=\"s-features-deprecated-in-3-0\">\n<span id=\"s-deprecated-features-3-0\"></span><span id=\"features-deprecated-in-3-0\"></span><span id=\"deprecated-features-3-0\"></span><h2>Features deprecated in 3.0<a class=\"headerlink\" href=\"#features-deprecated-in-3-0\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"s-django-utils-encoding-force-text-and-smart-text\">\n<span id=\"django-utils-encoding-force-text-and-smart-text\"></span><h3><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.encoding.force_text()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">smart_text()</span></code><a class=\"headerlink\" href=\"#django-utils-encoding-force-text-and-smart-text\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">smart_text()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">force_text()</span></code> aliases (since Django 2.0) of\n<code class=\"docutils literal notranslate\"><span class=\"pre\">smart_str()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">force_str()</span></code> are deprecated. Ignore this deprecation if\nyour code supports Python 2 as the behavior of <code class=\"docutils literal notranslate\"><span class=\"pre\">smart_str()</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">force_str()</span></code> is different there.</p>\n</div>\n<div class=\"section\" id=\"s-id3\">\n<span id=\"id3\"></span><h3>Miscellaneous<a class=\"headerlink\" href=\"#id3\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<ul class=\"simple\">\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.http.urlquote()</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">urlquote_plus()</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">urlunquote()</span></code>, and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">urlunquote_plus()</span></code> are deprecated in favor of the functions that they\u2019re\naliases for: <a class=\"reference external\" href=\"https://docs.python.org/3/library/urllib.parse.html#urllib.parse.quote\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">urllib.parse.quote()</span></code></a>, <a class=\"reference external\" href=\"https://docs.python.org/3/library/urllib.parse.html#urllib.parse.quote_plus\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">quote_plus()</span></code></a>,\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/urllib.parse.html#urllib.parse.unquote\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">unquote()</span></code></a>, and <a class=\"reference external\" href=\"https://docs.python.org/3/library/urllib.parse.html#urllib.parse.unquote_plus\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">unquote_plus()</span></code></a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.translation.ugettext()</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">ugettext_lazy()</span></code>,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">ugettext_noop()</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">ungettext()</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">ungettext_lazy()</span></code> are deprecated\nin favor of the functions that they\u2019re aliases for:\n<a class=\"reference internal\" href=\"../../ref/utils/#django.utils.translation.gettext\" title=\"django.utils.translation.gettext\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">django.utils.translation.gettext()</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/utils/#django.utils.translation.gettext_lazy\" title=\"django.utils.translation.gettext_lazy\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">gettext_lazy()</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/utils/#django.utils.translation.gettext_noop\" title=\"django.utils.translation.gettext_noop\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">gettext_noop()</span></code></a>,\n<a class=\"reference internal\" href=\"../../ref/utils/#django.utils.translation.ngettext\" title=\"django.utils.translation.ngettext\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">ngettext()</span></code></a>, and\n<a class=\"reference internal\" href=\"../../ref/utils/#django.utils.translation.ngettext_lazy\" title=\"django.utils.translation.ngettext_lazy\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">ngettext_lazy()</span></code></a>.</li>\n<li>To limit creation of sessions and hence favor some caching strategies,\n<a class=\"reference internal\" href=\"../../topics/i18n/translation/#django.views.i18n.set_language\" title=\"django.views.i18n.set_language\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">django.views.i18n.set_language()</span></code></a> will stop setting the user\u2019s language\nin the session in Django 4.0. Since Django 2.1, the language is always stored\nin the <a class=\"reference internal\" href=\"../../ref/settings/#std-setting-LANGUAGE_COOKIE_NAME\"><code class=\"xref std std-setting docutils literal notranslate\"><span class=\"pre\">LANGUAGE_COOKIE_NAME</span></code></a> cookie.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.text.unescape_entities()</span></code> is deprecated in favor of\n<a class=\"reference external\" href=\"https://docs.python.org/3/library/html.html#html.unescape\" title=\"(in Python v3.11)\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">html.unescape()</span></code></a>. Note that unlike <code class=\"docutils literal notranslate\"><span class=\"pre\">unescape_entities()</span></code>,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">html.unescape()</span></code> evaluates lazy strings immediately.</li>\n<li>To avoid possible confusion as to effective scope, the private internal\nutility <code class=\"docutils literal notranslate\"><span class=\"pre\">is_safe_url()</span></code> is renamed to\n<code class=\"docutils literal notranslate\"><span class=\"pre\">url_has_allowed_host_and_scheme()</span></code>. That a URL has an allowed host and\nscheme doesn\u2019t in general imply that it\u2019s \u201csafe\u201d. It may still be quoted\nincorrectly, for example. Ensure to also use\n<a class=\"reference internal\" href=\"../../ref/utils/#django.utils.encoding.iri_to_uri\" title=\"django.utils.encoding.iri_to_uri\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">iri_to_uri()</span></code></a> on the path component of untrusted\nURLs.</li>\n</ul>\n</div>\n</div>\n<div class=\"section\" id=\"s-features-removed-in-3-0\">\n<span id=\"s-removed-features-3-0\"></span><span id=\"features-removed-in-3-0\"></span><span id=\"removed-features-3-0\"></span><h2>Features removed in 3.0<a class=\"headerlink\" href=\"#features-removed-in-3-0\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>These features have reached the end of their deprecation cycle and are removed\nin Django 3.0.</p>\n<p>See <a class=\"reference internal\" href=\"../2.0/#deprecated-features-2-0\"><span class=\"std std-ref\">Features deprecated in 2.0</span></a> for details on these changes, including how\nto remove usage of these features.</p>\n<ul class=\"simple\">\n<li>The <code class=\"docutils literal notranslate\"><span class=\"pre\">django.db.backends.postgresql_psycopg2</span></code> module is removed.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.shortcuts.render_to_response()</span></code> is removed.</li>\n<li>The <code class=\"docutils literal notranslate\"><span class=\"pre\">DEFAULT_CONTENT_TYPE</span></code> setting is removed.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">HttpRequest.xreadlines()</span></code> is removed.</li>\n<li>Support for the <code class=\"docutils literal notranslate\"><span class=\"pre\">context</span></code> argument of <code class=\"docutils literal notranslate\"><span class=\"pre\">Field.from_db_value()</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Expression.convert_value()</span></code> is removed.</li>\n<li>The <code class=\"docutils literal notranslate\"><span class=\"pre\">field_name</span></code> keyword argument of <code class=\"docutils literal notranslate\"><span class=\"pre\">QuerySet.earliest()</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">latest()</span></code> is removed.</li>\n</ul>\n<p>See <a class=\"reference internal\" href=\"../2.1/#deprecated-features-2-1\"><span class=\"std std-ref\">Features deprecated in 2.1</span></a> for details on these changes, including how\nto remove usage of these features.</p>\n<ul class=\"simple\">\n<li>The <code class=\"docutils literal notranslate\"><span class=\"pre\">ForceRHR</span></code> GIS function is removed.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.http.cookie_date()</span></code> is removed.</li>\n<li>The <code class=\"docutils literal notranslate\"><span class=\"pre\">staticfiles</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">admin_static</span></code> template tag libraries are removed.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">django.contrib.staticfiles.templatetags.staticfiles.static()</span></code> is removed.</li>\n</ul>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["releases/2.2.28", "Django 2.2.28 release notes", "N", "next"], ["releases/3.0.1", "Django 3.0.1 release notes", "P", "previous"]], "sourcename": "releases/3.0.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Django 3.0 release notes</a><ul>\n<li><a class=\"reference internal\" href=\"#python-compatibility\">Python compatibility</a></li>\n<li><a class=\"reference internal\" href=\"#third-party-library-support-for-older-version-of-django\">Third-party library support for older version of Django</a></li>\n<li><a class=\"reference internal\" href=\"#what-s-new-in-django-3-0\">What\u2019s new in Django 3.0</a><ul>\n<li><a class=\"reference internal\" href=\"#mariadb-support\">MariaDB support</a></li>\n<li><a class=\"reference internal\" href=\"#asgi-support\">ASGI support</a></li>\n<li><a class=\"reference internal\" href=\"#exclusion-constraints-on-postgresql\">Exclusion constraints on PostgreSQL</a></li>\n<li><a class=\"reference internal\" href=\"#filter-expressions\">Filter expressions</a></li>\n<li><a class=\"reference internal\" href=\"#enumerations-for-model-field-choices\">Enumerations for model field choices</a></li>\n<li><a class=\"reference internal\" href=\"#minor-features\">Minor features</a><ul>\n<li><a class=\"reference internal\" href=\"#django-contrib-admin\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.admin</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#django-contrib-auth\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.auth</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#django-contrib-gis\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.gis</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#django-contrib-postgres\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.postgres</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#django-contrib-sessions\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.sessions</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#django-contrib-syndication\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.syndication</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#cache\">Cache</a></li>\n<li><a class=\"reference internal\" href=\"#file-storage\">File Storage</a></li>\n<li><a class=\"reference internal\" href=\"#forms\">Forms</a></li>\n<li><a class=\"reference internal\" href=\"#internationalization\">Internationalization</a></li>\n<li><a class=\"reference internal\" href=\"#logging\">Logging</a></li>\n<li><a class=\"reference internal\" href=\"#management-commands\">Management Commands</a></li>\n<li><a class=\"reference internal\" href=\"#models\">Models</a></li>\n<li><a class=\"reference internal\" href=\"#requests-and-responses\">Requests and Responses</a></li>\n<li><a class=\"reference internal\" href=\"#security\">Security</a></li>\n<li><a class=\"reference internal\" href=\"#tests\">Tests</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#backwards-incompatible-changes-in-3-0\">Backwards incompatible changes in 3.0</a><ul>\n<li><a class=\"reference internal\" href=\"#model-save-when-providing-a-default-for-the-primary-key\"><code class=\"docutils literal notranslate\"><span class=\"pre\">Model.save()</span></code> when providing a default for the primary key</a></li>\n<li><a class=\"reference internal\" href=\"#database-backend-api\">Database backend API</a></li>\n<li><a class=\"reference internal\" href=\"#id1\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.admin</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#id2\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">django.contrib.gis</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#dropped-support-for-postgresql-9-4\">Dropped support for PostgreSQL 9.4</a></li>\n<li><a class=\"reference internal\" href=\"#dropped-support-for-oracle-12-1\">Dropped support for Oracle 12.1</a></li>\n<li><a class=\"reference internal\" href=\"#removed-private-python-2-compatibility-apis\">Removed private Python 2 compatibility APIs</a></li>\n<li><a class=\"reference internal\" href=\"#new-default-value-for-the-file-upload-permissions-setting\">New default value for the <code class=\"docutils literal notranslate\"><span class=\"pre\">FILE_UPLOAD_PERMISSIONS</span></code> setting</a></li>\n<li><a class=\"reference internal\" href=\"#new-default-values-for-security-settings\">New default values for security settings</a></li>\n<li><a class=\"reference internal\" href=\"#miscellaneous\">Miscellaneous</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#features-deprecated-in-3-0\">Features deprecated in 3.0</a><ul>\n<li><a class=\"reference internal\" href=\"#django-utils-encoding-force-text-and-smart-text\"><code class=\"docutils literal notranslate\"><span class=\"pre\">django.utils.encoding.force_text()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">smart_text()</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#id3\">Miscellaneous</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#features-removed-in-3-0\">Features removed in 3.0</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".txt", "current_page_name": "releases/3.0", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}
