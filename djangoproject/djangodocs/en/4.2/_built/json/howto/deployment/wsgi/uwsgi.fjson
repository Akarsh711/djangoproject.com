{"parents": [{"link": "../../../", "title": "\u201cHow-to\u201d guides"}, {"link": "../../", "title": "How to deploy Django"}, {"link": "../", "title": "How to deploy with WSGI"}], "prev": {"link": "../gunicorn/", "title": "How to use Django with Gunicorn"}, "next": {"link": "../modwsgi/", "title": "How to use Django with Apache and <code class=\"docutils literal notranslate\"><span class=\"pre\">mod_wsgi</span></code>"}, "title": "How to use Django with uWSGI", "meta": {}, "body": "<div class=\"section\" id=\"s-how-to-use-django-with-uwsgi\">\n<span id=\"how-to-use-django-with-uwsgi\"></span><h1>How to use Django with uWSGI<a class=\"headerlink\" href=\"#how-to-use-django-with-uwsgi\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p><a class=\"reference external\" href=\"https://uwsgi-docs.readthedocs.io/\">uWSGI</a> is a fast, self-healing and developer/sysadmin-friendly application\ncontainer server coded in pure C.</p>\n<div class=\"admonition seealso\">\n<p class=\"first admonition-title\">See also</p>\n<p class=\"last\">The uWSGI docs offer a <a class=\"reference external\" href=\"https://uwsgi.readthedocs.io/en/latest/tutorials/Django_and_nginx.html\">tutorial</a> covering Django, nginx, and uWSGI (one\npossible deployment setup of many). The docs below are focused on how to\nintegrate Django with uWSGI.</p>\n</div>\n<div class=\"section\" id=\"s-prerequisite-uwsgi\">\n<span id=\"prerequisite-uwsgi\"></span><h2>Prerequisite: uWSGI<a class=\"headerlink\" href=\"#prerequisite-uwsgi\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>The uWSGI wiki describes several <a class=\"reference external\" href=\"https://uwsgi-docs.readthedocs.io/en/latest/Install.html\">installation procedures</a>. Using pip, the\nPython package manager, you can install any uWSGI version with a single\ncommand. For example:</p>\n<div class=\"highlight-console notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\"># </span>Install current stable version.\n<span class=\"gp\">$ </span>python -m pip install uwsgi\n\n<span class=\"gp\"># </span>Or install LTS <span class=\"o\">(</span>long term support<span class=\"o\">)</span>.\n<span class=\"gp\">$ </span>python -m pip install https://projects.unbit.it/downloads/uwsgi-lts.tar.gz\n</pre></div>\n</div>\n<div class=\"section\" id=\"s-uwsgi-model\">\n<span id=\"uwsgi-model\"></span><h3>uWSGI model<a class=\"headerlink\" href=\"#uwsgi-model\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>uWSGI operates on a client-server model. Your web server (e.g., nginx, Apache)\ncommunicates with a <code class=\"docutils literal notranslate\"><span class=\"pre\">django-uwsgi</span></code> \u201cworker\u201d process to serve dynamic content.</p>\n</div>\n<div class=\"section\" id=\"s-configuring-and-starting-the-uwsgi-server-for-django\">\n<span id=\"configuring-and-starting-the-uwsgi-server-for-django\"></span><h3>Configuring and starting the uWSGI server for Django<a class=\"headerlink\" href=\"#configuring-and-starting-the-uwsgi-server-for-django\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>uWSGI supports multiple ways to configure the process. See uWSGI\u2019s\n<a class=\"reference external\" href=\"https://uwsgi.readthedocs.io/en/latest/Configuration.html\">configuration documentation</a>.</p>\n<p>Here\u2019s an example command to start a uWSGI server:</p>\n<div class=\"highlight-shell notranslate\"><div class=\"highlight\"><pre><span></span>uwsgi --chdir<span class=\"o\">=</span>/path/to/your/project <span class=\"se\">\\</span>\n    --module<span class=\"o\">=</span>mysite.wsgi:application <span class=\"se\">\\</span>\n    --env <span class=\"nv\">DJANGO_SETTINGS_MODULE</span><span class=\"o\">=</span>mysite.settings <span class=\"se\">\\</span>\n    --master --pidfile<span class=\"o\">=</span>/tmp/project-master.pid <span class=\"se\">\\</span>\n    --socket<span class=\"o\">=</span><span class=\"m\">127</span>.0.0.1:49152 <span class=\"se\">\\ </span>     <span class=\"c1\"># can also be a file</span>\n    --processes<span class=\"o\">=</span><span class=\"m\">5</span> <span class=\"se\">\\ </span>                <span class=\"c1\"># number of worker processes</span>\n    --uid<span class=\"o\">=</span><span class=\"m\">1000</span> --gid<span class=\"o\">=</span><span class=\"m\">2000</span> <span class=\"se\">\\ </span>        <span class=\"c1\"># if root, uwsgi can drop privileges</span>\n    --harakiri<span class=\"o\">=</span><span class=\"m\">20</span> <span class=\"se\">\\ </span>                <span class=\"c1\"># respawn processes taking more than 20 seconds</span>\n    --max-requests<span class=\"o\">=</span><span class=\"m\">5000</span> <span class=\"se\">\\ </span>          <span class=\"c1\"># respawn processes after serving 5000 requests</span>\n    --vacuum <span class=\"se\">\\ </span>                     <span class=\"c1\"># clear environment on exit</span>\n    --home<span class=\"o\">=</span>/path/to/virtual/env <span class=\"se\">\\ </span>  <span class=\"c1\"># optional path to a virtual environment</span>\n    --daemonize<span class=\"o\">=</span>/var/log/uwsgi/yourproject.log      <span class=\"c1\"># background the process</span>\n</pre></div>\n</div>\n<p>This assumes you have a top-level project package named <code class=\"docutils literal notranslate\"><span class=\"pre\">mysite</span></code>, and\nwithin it a module <code class=\"file docutils literal notranslate\"><span class=\"pre\">mysite/wsgi.py</span></code> that contains a WSGI <code class=\"docutils literal notranslate\"><span class=\"pre\">application</span></code>\nobject. This is the layout you\u2019ll have if you ran <code class=\"docutils literal notranslate\"><span class=\"pre\">django-admin</span>\n<span class=\"pre\">startproject</span> <span class=\"pre\">mysite</span></code> (using your own project name in place of <code class=\"docutils literal notranslate\"><span class=\"pre\">mysite</span></code>) with\na recent version of Django. If this file doesn\u2019t exist, you\u2019ll need to create\nit. See the <a class=\"reference internal\" href=\"../\"><span class=\"doc\">How to deploy with WSGI</span></a> documentation for the default\ncontents you should put in this file and what else you can add to it.</p>\n<p>The Django-specific options here are:</p>\n<ul class=\"simple\">\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">chdir</span></code>: The path to the directory that needs to be on Python\u2019s import\npath \u2013 i.e., the directory containing the <code class=\"docutils literal notranslate\"><span class=\"pre\">mysite</span></code> package.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">module</span></code>: The WSGI module to use \u2013 probably the <code class=\"docutils literal notranslate\"><span class=\"pre\">mysite.wsgi</span></code> module\nthat <a class=\"reference internal\" href=\"../../../../ref/django-admin/#django-admin-startproject\"><code class=\"xref std std-djadmin docutils literal notranslate\"><span class=\"pre\">startproject</span></code></a> creates.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">env</span></code>: Should probably contain at least <span class=\"target\" id=\"index-0\"></span><a class=\"reference internal\" href=\"../../../../topics/settings/#envvar-DJANGO_SETTINGS_MODULE\"><code class=\"xref std std-envvar docutils literal notranslate\"><span class=\"pre\">DJANGO_SETTINGS_MODULE</span></code></a>.</li>\n<li><code class=\"docutils literal notranslate\"><span class=\"pre\">home</span></code>: Optional path to your project virtual environment.</li>\n</ul>\n<p>Example ini configuration file:</p>\n<div class=\"highlight-ini notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">[uwsgi]</span><span class=\"w\"></span>\n<span class=\"na\">chdir</span><span class=\"o\">=</span><span class=\"s\">/path/to/your/project</span><span class=\"w\"></span>\n<span class=\"na\">module</span><span class=\"o\">=</span><span class=\"s\">mysite.wsgi:application</span><span class=\"w\"></span>\n<span class=\"na\">master</span><span class=\"o\">=</span><span class=\"s\">True</span><span class=\"w\"></span>\n<span class=\"na\">pidfile</span><span class=\"o\">=</span><span class=\"s\">/tmp/project-master.pid</span><span class=\"w\"></span>\n<span class=\"na\">vacuum</span><span class=\"o\">=</span><span class=\"s\">True</span><span class=\"w\"></span>\n<span class=\"na\">max-requests</span><span class=\"o\">=</span><span class=\"s\">5000</span><span class=\"w\"></span>\n<span class=\"na\">daemonize</span><span class=\"o\">=</span><span class=\"s\">/var/log/uwsgi/yourproject.log</span><span class=\"w\"></span>\n</pre></div>\n</div>\n<p>Example ini configuration file usage:</p>\n<div class=\"highlight-shell notranslate\"><div class=\"highlight\"><pre><span></span>uwsgi --ini uwsgi.ini\n</pre></div>\n</div>\n<div class=\"admonition-fixing-unicodeencodeerror-for-file-uploads admonition\">\n<p class=\"first admonition-title\">Fixing <code class=\"docutils literal notranslate\"><span class=\"pre\">UnicodeEncodeError</span></code> for file uploads</p>\n<p>If you get a <code class=\"docutils literal notranslate\"><span class=\"pre\">UnicodeEncodeError</span></code> when uploading files with file names\nthat contain non-ASCII characters, make sure uWSGI is configured to accept\nnon-ASCII file names by adding this to your <code class=\"docutils literal notranslate\"><span class=\"pre\">uwsgi.ini</span></code>:</p>\n<div class=\"highlight-ini notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"na\">env</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">LANG=en_US.UTF-8</span><span class=\"w\"></span>\n</pre></div>\n</div>\n<p class=\"last\">See the <a class=\"reference internal\" href=\"../../../../ref/unicode/#unicode-files\"><span class=\"std std-ref\">Files</span></a> section of the Unicode reference guide for\ndetails.</p>\n</div>\n<p>See the uWSGI docs on <a class=\"reference external\" href=\"https://uwsgi-docs.readthedocs.io/en/latest/Management.html\">managing the uWSGI process</a> for information on\nstarting, stopping and reloading the uWSGI workers.</p>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["howto/deployment/wsgi/modwsgi", "How to use Django with Apache and <code class=\"docutils literal notranslate\"><span class=\"pre\">mod_wsgi</span></code>", "N", "next"], ["howto/deployment/wsgi/gunicorn", "How to use Django with Gunicorn", "P", "previous"]], "sourcename": "howto/deployment/wsgi/uwsgi.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">How to use Django with uWSGI</a><ul>\n<li><a class=\"reference internal\" href=\"#prerequisite-uwsgi\">Prerequisite: uWSGI</a><ul>\n<li><a class=\"reference internal\" href=\"#uwsgi-model\">uWSGI model</a></li>\n<li><a class=\"reference internal\" href=\"#configuring-and-starting-the-uwsgi-server-for-django\">Configuring and starting the uWSGI server for Django</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".txt", "current_page_name": "howto/deployment/wsgi/uwsgi", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "include_console_assets": false}
